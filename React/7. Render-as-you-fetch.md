## Render-as-you-fetch

### Render-as-you-fetch 패턴이란?

기존의 데이터 페칭 방식은 '폭포수(waterfall)' 형태로 데이터가 로드된 후에야 렌더링이 시작되므로, 네트워크 지연으로 인해 사용자에게 빈 화면이나 로딩 스피너가 오래 노출될 수 있습니다.

Render-as-you-fetch 패턴은 이러한 문제를 해결하기 위해, **데이터를 가져오기 시작하는 동시에 컴포넌트를 렌더링**하는 방식을 채택합니다.

**핵심 아이디어:**

- 데이터 요청을 최대한 빨리 시작합니다. (렌더링 직전 또는 렌더링 중)
- 데이터가 준비될 때까지 UI 렌더링을 차단하지 않습니다.
- `Suspense`와 `ErrorBoundary`를 활용하여 비동기 작업의 로딩 및 에러 상태를 선언적으로 관리합니다.

이는 `useEffect`나 `useState`를 이용한 수동적인 로딩 및 에러 상태 관리 대신, React의 내장된 메커니즘을 활용하여 더 간결하고 예측 가능한 코드 작성을 가능하게 합니다.

---

### `Suspense`를 이용한 로딩 상태 처리

데이터가 로드되는 동안 사용자에게 일관된 로딩 경험을 제공하는 핵심적인 역할을 합니다. 데이터 페칭이 시작되고 결과가 아직 준비되지 않은 '보류(pending)' 상태일 때, `Suspense`는 트리거되어 `fallback`으로 지정된 UI를 렌더링합니다.

**작동 원리:**

1.  **데이터 페칭 시작**: 데이터가 아직 준비되지 않았다면 Promise를 'throw'합니다.
2.  **`Suspense` 감지**: `Suspense` 컴포넌트는 하위 컴포넌트 트리에서 이러한 Promise 'throw'를 감지합니다.
3.  **폴백(Fallback) UI 렌더링**: Promise가 해결될 때까지, `Suspense`는 `fallback` prop으로 전달받은 로딩 인디케이터를 화면에 보여줍니다.
4.  **데이터 로드 및 실제 UI 렌더링**: 데이터 로딩이 완료되어 Promise가 해결되면, `Suspense`는 `fallback` UI를 숨기고 실제 데이터가 채워진 컴포넌트를 렌더링합니다.

---

### `ErrorBoundary`를 이용한 실패 상태 처리

데이터 페칭 과정에서 발생하는 예측 불가능한 오류를 캐치하고 사용자에게 적절한 실패 UI를 보여줍니다.

**작동 원리:**

1.  **데이터 페칭 중 오류 발생**: 데이터를 가져오는 비동기 함수가 Promise를 'reject'하거나, 동기적으로 오류를 'throw'합니다.
2.  **폴백(Fallback) UI 렌더링**: 오류를 감지하면 `ErrorBoundary`는 `fallback` prop으로 전달받은 오류 메시지나 오류 발생 시 보여줄 대체 UI를 화면에 렌더링합니다. 이 과정에서 `ErrorBoundary`는 오류 정보를 로깅할 수도 있습니다.
3.  **오류 복구 시도 (선택 사항)**: 일부 `ErrorBoundary` 구현에서는 오류 발생 후 다시 데이터 페칭을 시도하거나, 특정 액션을 통해 오류 상태를 복구할 수 있는 메커니즘을 제공하기도 합니다.
