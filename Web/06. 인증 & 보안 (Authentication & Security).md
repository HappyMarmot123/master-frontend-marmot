# μΈμ¦ & λ³΄μ• (Authentication & Security)

## π“– κ°μ”

μ›Ή λ³΄μ•μ€ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…κ³Ό μ›Ήμ‚¬μ΄νΈλ¥Ό λ‹¤μ–‘ν• κ³µκ²©μΌλ΅λ¶€ν„° λ³΄νΈν•λ” κ²ƒμ…λ‹λ‹¤. μ‚¬μ©μ λ°μ΄ν„° λ³΄νΈμ™€ μ„λΉ„μ¤ μ•μ •μ„±μ„ μ„ν•΄ ν•„μμ μ…λ‹λ‹¤.

μ›Ή λ³΄μ•μ€ λ‹¨μν• κΈ°μ μ  μ”κµ¬μ‚¬ν•­μ„ λ„μ–΄μ„ μ‚¬μ©μ μ‹ λΆ°μ™€ λΉ„μ¦λ‹μ¤ μ§€μ†κ°€λ¥μ„±μ„ λ³΄μ¥ν•λ” ν•µμ‹¬ μ”μ†μ…λ‹λ‹¤. λ³΄μ• μ·¨μ•½μ μ€ μ‚¬μ©μμ κ°μΈμ •λ³΄ μ μ¶, κΈμµμ  μ†μ‹¤, λΈλλ“ μ΄λ―Έμ§€ ν›Όμ† λ“± μ‹¬κ°ν• κ²°κ³Όλ¥Ό μ΄λν•  μ μμΌλ©°, μ΄λ” μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ μ„±κ³µκ³Ό μ‹¤ν¨λ¥Ό κ°€λ¥΄λ” μ¤‘μ”ν• κΈ°μ¤€μ΄ λ©λ‹λ‹¤.

## **λ°μ΄ν„° λ³΄νΈ (Data Protection)**

μ „μ†΅ μ¤‘μ΄κ±°λ‚ μ €μ¥λ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ³  λ³΄νΈν•λ” κ³Όμ •μ…λ‹λ‹¤.

**λ°μ΄ν„° λ³΄νΈμ ν•µμ‹¬ μ”μ†:**

- **μ „μ†΅ μ¤‘ μ•”νΈν™” (Encryption in Transit)**: ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ λ°μ΄ν„° μ „μ†΅ κ³Όμ •μ—μ„ μ•”νΈν™”λ¥Ό μ μ©ν•μ—¬ μ¤‘κ°„μ κ³µκ²©(Man-in-the-Middle Attack)μ„ λ°©μ§€ν•©λ‹λ‹¤. HTTPS/TLS ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•μ—¬ λ¨λ“  ν†µμ‹ μ„ μ•”νΈν™”ν•κ³ , μΈμ¦μ„λ¥Ό ν†µν•΄ μ„λ²„μ μ‹ μ›μ„ ν™•μΈν•©λ‹λ‹¤. νΉν λ΅κ·ΈμΈ μ •λ³΄, κ°μΈμ •λ³΄, κΈμµ λ°μ΄ν„° λ“± λ―Όκ°ν• μ •λ³΄λ¥Ό μ „μ†΅ν•  λ•λ” λ°λ“μ‹ HTTPSλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
- **μ €μ¥ λ°μ΄ν„° μ•”νΈν™” (Encryption at Rest)**: λ°μ΄ν„°λ² μ΄μ¤λ‚ νμΌ μ‹μ¤ν…μ— μ €μ¥λ λ―Όκ°ν• μ •λ³΄λ¥Ό μ•”νΈν™”ν•μ—¬ μ €μ¥ν•©λ‹λ‹¤. μ΄λ” λ°μ΄ν„°λ² μ΄μ¤ μΉ¨ν•΄λ‚ λ¬Όλ¦¬μ  λ³΄μ• μ‚¬κ³ κ°€ λ°μƒν–μ„ λ•λ„ λ°μ΄ν„°λ¥Ό λ³΄νΈν•  μ μκ² ν•΄μ¤λ‹λ‹¤. λΉ„λ°€λ²νΈλ” λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μ(μ: bcrypt, Argon2)λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™”ν•κ³ , κ°μΈμ •λ³΄λ” λ€μΉ­ν‚¤ μ•”νΈν™”λ¥Ό μ‚¬μ©ν•μ—¬ μ €μ¥ν•©λ‹λ‹¤.
- **λ°μ΄ν„° λ¬΄κ²°μ„± (Data Integrity)**: λ°μ΄ν„°κ°€ μ „μ†΅λκ±°λ‚ μ €μ¥λλ” κ³Όμ •μ—μ„ λ³€μ΅°λμ§€ μ•μ•μμ„ λ³΄μ¥ν•©λ‹λ‹¤. ν•΄μ‹ ν•¨μλ‚ λ””μ§€ν„Έ μ„λ…μ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ κ²€μ¦ν•κ³ , λ°μ΄ν„°κ°€ λ³€κ²½λμ—μ„ κ²½μ° μ΄λ¥Ό κ°μ§€ν•  μ μμµλ‹λ‹¤. λν• λ°±μ—… λ°μ΄ν„°μ λ¬΄κ²°μ„±λ„ μ •κΈ°μ μΌλ΅ κ²€μ¦ν•μ—¬ λ°μ΄ν„° μ†μ‹¤μ„ λ°©μ§€ν•©λ‹λ‹¤.

## π”’ λ°μ΄ν„° κ΄€λ ¨ μ„ν‘ λ°©μ–΄ μ „λµ

### **SQL μΈμ μ… (SQL Injection)**

κ³µκ²©μκ°€ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ μ…λ ¥ ν•„λ“μ— μ•…μ„± SQL μ½”λ“λ¥Ό μ‚½μ…ν•μ—¬ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ΅°μ‘ν•λ” κ³µκ²©μ…λ‹λ‹¤. μ΄λ” μ‚¬μ©μ μ…λ ¥μ„ μ μ ν κ²€μ¦ν•κ±°λ‚ μ΄μ¤μΌ€μ΄ν”„ν•μ§€ μ•μ„ λ• λ°μƒν•  μ μμµλ‹λ‹¤. μ‚¬μ©μμ μ…λ ¥μ„ SQL μΏΌλ¦¬μ μΌλ¶€κ°€ μ•„λ‹ λ°μ΄ν„°λ΅ μ·¨κΈ‰ν•κ² λ§λ“¤μ–΄ ν•΄κ²°ν•©λ‹λ‹¤.

### **XSS (Cross-Site Scripting)**

κ³µκ²©μκ°€ μ›Ή νμ΄μ§€μ— μ•…μ„± μ¤ν¬λ¦½νΈλ¥Ό μ‚½μ…ν•μ—¬ λ‹¤λ¥Έ μ‚¬μ©μμ λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λλ„λ΅ ν•λ” κ³µκ²©μ…λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ‚¬μ©μμ μ„Έμ… μΏ ν‚¤λ¥Ό νƒμ·¨ν•κ±°λ‚, κ°μΈμ •λ³΄λ¥Ό λΉΌλ‚΄κ±°λ‚, μ›Ήμ‚¬μ΄νΈμ λ‚΄μ©μ„ λ³€μ΅°ν•  μ μμµλ‹λ‹¤.

- **μ…λ ¥ λ°μ΄ν„° κ²€μ¦ λ° μ΄μ¤μΌ€μ΄ν”„:** μ‚¬μ©μλ΅λ¶€ν„° μ…λ ¥λ°›μ€ λ°μ΄ν„°μ— ν¬ν•¨λ  μ μλ” μ¤ν¬λ¦½νΈ κ΄€λ ¨ λ¬Έμ(μ: `<`, `>`, `"` λ“±)λ¥Ό HTML μ—”ν‹°ν‹°(`&lt;`, `&gt;`, `&quot;` λ“±)λ΅ λ³€ν™(μ΄μ¤μΌ€μ΄ν”„)ν•μ—¬ μ¤ν¬λ¦½νΈκ°€ μ‹¤ν–‰λμ§€ μ•λ„λ΅ ν•©λ‹λ‹¤.
- **μ¶λ ¥ μ‹ μ΄μ¤μΌ€μ΄ν”„:** λ°μ΄ν„°λ² μ΄μ¤λ‚ νμΌμ—μ„ μ½μ–΄μ¨ λ°μ΄ν„°λ¥Ό HTMLμ— μ¶λ ¥ν•  λ•, ν•΄λ‹Ή λ°μ΄ν„°μ— ν¬ν•¨λ μ¤ν¬λ¦½νΈκ°€ μ‹¤ν–‰λμ§€ μ•λ„λ΅ μ΄μ¤μΌ€μ΄ν”„ μ²λ¦¬λ¥Ό ν•΄μ•Ό ν•©λ‹λ‹¤.
- **Content Security Policy (CSP):** λΈλΌμ°μ €μ— μ‹ λΆ°ν•  μ μλ” μ¤ν¬λ¦½νΈ μ†μ¤λ¥Ό λ…μ‹ν•μ—¬, ν—μ©λμ§€ μ•μ€ μ™Έλ¶€ μ¤ν¬λ¦½νΈκ°€ μ‹¤ν–‰λλ” κ²ƒμ„ λ°©μ§€ν•λ” κ°•λ ¥ν• λ³΄μ• μ •μ±…μ…λ‹λ‹¤. `Content-Security-Policy` HTTP ν—¤λ”λ¥Ό ν†µν•΄ μ„¤μ •ν•  μ μμµλ‹λ‹¤.

### **CSRF (Cross-Site Request Forgery)**

κ³µκ²©μκ°€ μΈμ¦λ μ‚¬μ©μμ κ¶ν•μ„ μ΄μ©ν•μ—¬ μ‚¬μ©μκ°€ μλ„ν•μ§€ μ•μ€ μ‘μ—…μ„ μν–‰ν•λ„λ΅ ν•λ” κ³µκ²©μ…λ‹λ‹¤. μ΄λ” μ‚¬μ©μκ°€ μ•…μ„± μ›Ήμ‚¬μ΄νΈλ¥Ό λ°©λ¬Έν•κ±°λ‚ μ΄λ©”μΌμ λ§ν¬λ¥Ό ν΄λ¦­ν•  λ• λ°μƒν•  μ μμµλ‹λ‹¤. λ°©μ–΄ λ°©λ²•μΌλ΅λ” CSRF ν† ν° μ‚¬μ©, SameSite μΏ ν‚¤ μ„¤μ •, Referer ν—¤λ” κ²€μ¦, μ‚¬μ©μ ν™•μΈ μ μ°¨ μ¶”κ°€ λ“±μ΄ μμµλ‹λ‹¤.

### νμΌ μ—…λ΅λ“ λ³΄μ•

νμΌ μ—…λ΅λ“λ” μ›Ή μ…Έ(web shell)κ³Ό κ°™μ€ μ•…μ„± νμΌμ΄ μ„λ²„μ— μ—…λ΅λ“λμ–΄ μ‹¤ν–‰λ  κ²½μ° μ‹¬κ°ν• λ³΄μ• μ„ν‘μ΄ λ  μ μμµλ‹λ‹¤. λ”°λΌμ„ νμΌ μ—…λ΅λ“ κΈ°λ¥μ€ μ‹ μ¤‘ν•κ² κµ¬ν„ν•΄μ•Ό ν•©λ‹λ‹¤.

λ‹¤μκ³Ό κ°™μ€ μ΅°μΉλ¥Ό ν†µν•΄ νμΌ μ—…λ΅λ“ μ·¨μ•½μ μ„ λ°©μ–΄ν•  μ μμµλ‹λ‹¤:

- **νμΌ νƒ€μ… κ²€μ¦:** `Content-Type` ν—¤λ”(MIME νƒ€μ…)μ™€ νμΌ ν™•μ¥μλ¥Ό λ¨λ‘ κ²€μ¦ν•μ—¬ ν—μ©λ νμΌ ν•μ‹λ§ μ—…λ΅λ“λλ„λ΅ μ ν•ν•©λ‹λ‹¤.
- **νμΌ ν¬κΈ° μ ν•:** λΉ„μ •μƒμ μΌλ΅ ν° νμΌ μ—…λ΅λ“λ¥Ό λ§‰μ•„ μ„λΉ„μ¤ κ±°λ¶€(DoS) κ³µκ²©μ„ λ°©μ§€ν•©λ‹λ‹¤.
- **μ•μ „ν• νμΌλ… μ‚¬μ©:** μ‚¬μ©μκ°€ μ…λ ¥ν• νμΌλ… λ€μ‹ , μ„λ²„μ—μ„ μ„μμ κ³ μ ν• νμΌλ…μ„ μƒμ„±ν•μ—¬ μ €μ¥ν•©λ‹λ‹¤. μ΄λ” κ²½λ΅ μ΅°μ‘(Path Traversal) κ³µκ²©μ„ λ°©μ§€ν•λ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤.
- **μ‹¤ν–‰ κ¶ν• μ κ±°:** μ—…λ΅λ“λ νμΌμ΄ μ €μ¥λλ” λ””λ ‰ν† λ¦¬μ μ‹¤ν–‰ κ¶ν•μ„ μ κ±°ν•μ—¬, μ›Ή μ…Έκ³Ό κ°™μ€ μ¤ν¬λ¦½νΈκ°€ μ‹¤ν–‰λμ§€ μ•λ„λ΅ ν•©λ‹λ‹¤.

```javascript
const multer = require("multer");
const path = require("path");

// νμΌ νƒ€μ… κ²€μ¦
const fileFilter = (req, file, cb) => {
  const allowedTypes = ["image/jpeg", "image/png", "image/gif"];

  if (allowedTypes.includes(file.mimetype)) {
    cb(null, true);
  } else {
    cb(new Error("Invalid file type"), false);
  }
};

// νμΌ ν¬κΈ° μ ν•
const storage = multer.diskStorage({
  destination: (req, file, cb) => {
    cb(null, "uploads/");
  },
  filename: (req, file, cb) => {
    // μ›λ³Έ νμΌλ… λ€μ‹  μ•μ „ν• νμΌλ… μƒμ„±
    const uniqueSuffix = Date.now() + "-" + Math.round(Math.random() * 1e9);
    cb(null, uniqueSuffix + path.extname(file.originalname));
  },
});

const upload = multer({
  storage: storage,
  fileFilter: fileFilter,
  limits: {
    fileSize: 5 * 1024 * 1024, // 5MB
    files: 1,
  },
});

// νμΌ ν™•μ¥μ κ²€μ¦
function validateFileExtension(filename) {
  const allowedExtensions = [".jpg", ".jpeg", ".png", ".gif"];
  const ext = path.extname(filename).toLowerCase();
  return allowedExtensions.includes(ext);
}
```

### λ³΄μ• ν—¤λ” μ„¤μ •

```javascript
const helmet = require("helmet");

app.use(helmet());

// μ¶”κ°€ λ³΄μ• ν—¤λ”
app.use((req, res, next) => {
  // XSS λ°©μ§€
  res.setHeader("X-XSS-Protection", "1; mode=block");

  // ν΄λ¦­μ¬ν‚Ή λ°©μ§€
  res.setHeader("X-Frame-Options", "DENY");

  // MIME νƒ€μ… μ¤λ‹ν•‘ λ°©μ§€
  res.setHeader("X-Content-Type-Options", "nosniff");

  // HSTS (HTTPS κ°•μ )
  res.setHeader(
    "Strict-Transport-Security",
    "max-age=31536000; includeSubDomains"
  );

  // Content Security Policy
  res.setHeader(
    "Content-Security-Policy",
    "default-src 'self'; " +
      "script-src 'self' 'unsafe-inline'; " +
      "style-src 'self' 'unsafe-inline'; " +
      "img-src 'self' data: https:; " +
      "font-src 'self'; " +
      "connect-src 'self';"
  );

  next();
});
```

## λ³΄μ• λ¨λ²” μ‚¬λ΅€

### 1. **λ³΄μ• μ›μΉ™**

**μµμ† κ¶ν• μ›μΉ™:**

- μ‚¬μ©μμ—κ² ν•„μ”ν• μµμ†ν•μ κ¶ν•λ§ λ¶€μ—¬
- κ΄€λ¦¬μ κ¶ν•μ€ κΌ­ ν•„μ”ν• κ²½μ°μ—λ§ μ‚¬μ©

**β­ λ°©μ–΄μ  ν”„λ΅κ·Έλλ° β­:**

- λ¨λ“  μ…λ ¥ λ°μ΄ν„° κ²€μ¦
- μμƒμΉ λ»ν• μƒν™©μ— λ€ν• μ•μ „ μ¥μΉ
- μ‹¤ν¨ μ‹ μ•μ „ν• κΈ°λ³Έκ°’ μ‚¬μ©
