# ë²ˆë“¤ ìµœì í™” (Bundle Optimization)

## ğŸ“– ê°œìš”

**ë²ˆë“¤ ìµœì í™”(Bundle Optimization)** ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ JavaScript, CSS, ê¸°íƒ€ ìì‚°ë“¤ì„ íš¨ìœ¨ì ìœ¼ë¡œ íŒ¨í‚¤ì§•í•˜ê³  ì „ë‹¬í•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì´ˆê¸° ë¡œë”© ì‹œê°„ì„ ë‹¨ì¶•í•˜ê³ , ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¤ë©°, ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ì„ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë‹¨ì¼ ë²ˆë“¤ì€ í•œê³„ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.** í•„ìš”í•˜ì§€ ì•Šì•„ë„ ëª¨ë“  ì½”ë“œë¥¼ í•œ ë²ˆì— ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì²« í˜ì´ì§€ ë¡œë”© ì‹œê°„ ì¦ê°€ë¡œ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê¹Œì§€ í¬í•¨ì´ ë˜ë¯€ë¡œ ìºì‹± íš¨ìœ¨ì„±ë„ ë‚®ê³  ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•©ë‹ˆë‹¤.

### ë²ˆë“¤ ìµœì í™”ì˜ í•´ê²°ì±…

- **ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…**: í•„ìš”í•œ ì½”ë“œë§Œ ë¡œë“œí•˜ì—¬ ì´ˆê¸° ë¡œë”© ì‹œê°„ ë‹¨ì¶•
- **Tree Shaking**: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ì œê±°ë¡œ ë²ˆë“¤ í¬ê¸° ê°ì†Œ
- **Minification**: ì½”ë“œ ì••ì¶•ìœ¼ë¡œ ì „ì†¡ í¬ê¸° ìµœì†Œí™”
- **Vendor Chunk**: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œ ë¶„ë¦¬ë¡œ ìºì‹± íš¨ìœ¨ì„± í–¥ìƒ

## 1. ì½”ë“œ ìŠ¤í”Œë¦¬íŒ… (Code Splitting)

**ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…(Code Splitting)** ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ JavaScript ë²ˆë“¤ì„ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ì²­í¬(chunk)ë¡œ ë‚˜ëˆ„ì–´ í•„ìš”í•  ë•Œë§Œ ë¡œë“œí•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì´ˆê¸° ë²ˆë“¤ í¬ê¸°ë¥¼ ì¤„ì´ê³ , ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ í•„ìš”ë¡œ í•˜ëŠ” ì½”ë“œë§Œ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì›¹ ì„±ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Webpackì„ í™œìš©í•œ Entry Point **ë¶„í• **:

```javascript
// webpack.config.js
const path = require("path");

module.exports = {
  entry: {
    main: "./src/main.js",
    vendor: "./src/vendor.js",
  },
  output: {
    filename: "[name].[contenthash].js",
    path: path.resolve(__dirname, "dist"),
    clean: true,
  },
  optimization: {
    splitChunks: {
      chunks: "all",
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: "vendors",
          chunks: "all",
        },
        common: {
          name: "common",
          minChunks: 2,
          chunks: "all",
          enforce: true,
        },
      },
    },
  },
};
```

**Lazy Load(ì§€ì—° ë¡œë”©)** ëŠ” ì›¹ í˜ì´ì§€ì˜ ë¦¬ì†ŒìŠ¤(ì´ë¯¸ì§€, ë¹„ë””ì˜¤, ìŠ¤í¬ë¦½íŠ¸ ë“±)ë¥¼ ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ í•„ìš”ë¡œ í•  ë•Œê¹Œì§€ ë¡œë”©ì„ ì§€ì—°ì‹œí‚¤ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì´ˆê¸° í˜ì´ì§€ ë¡œë”© ì‹œê°„ì„ ë‹¨ì¶•í•˜ê³ , ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œë¥¼ ë°©ì§€í•˜ì—¬ ì›¹ ì„±ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë¼ìš°íŠ¸ ê¸°ë°˜ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…**:

```jsx
// í˜ì´ì§€ë³„ ë™ì  ì„í¬íŠ¸
const Home = lazy(() => import("./pages/Home"));
const About = lazy(() => import("./pages/About"));

function App() {
  return (
    <BrowserRouter>
      <Suspense fallback={<LoadingSpinner />}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}

export default App;
```

í”„ë¦¬í˜ì¹­ì€ ë¯¸ë˜ íƒìƒ‰ ëŒ€ë¹„ ì‚¬ì „ ë‹¤ìš´ë¡œë“œë¥¼ ì§„í–‰í•˜ë¯€ë¡œ ì‚¬ìš©ì í–‰ë™ ì˜ˆì¸¡ì„ í†µí•œ ìµœì í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```jsx
// hooks/usePrefetch.js
import { useCallback } from "react";

export const usePrefetch = () => {
  const prefetchComponent = useCallback((importFunc) => {
    // ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ í”„ë¦¬í˜ì¹­
    importFunc();
  }, []);

  const prefetchOnHover = useCallback(
    (importFunc, delay = 100) => {
      let timeoutId;

      const handleMouseEnter = () => {
        timeoutId = setTimeout(() => {
          prefetchComponent(importFunc);
        }, delay);
      };

      const handleMouseLeave = () => {
        if (timeoutId) {
          clearTimeout(timeoutId);
        }
      };

      return { handleMouseEnter, handleMouseLeave };
    },
    [prefetchComponent]
  );

  return { prefetchComponent, prefetchOnHover };
};

// ì‚¬ìš© ì˜ˆì‹œ
function Navigation() {
  const { prefetchOnHover } = usePrefetch();
  const handleAboutHover = prefetchOnHover(() => import("../pages/About"));
  const handleContactHover = prefetchOnHover(() => import("../pages/Contact"));

  return (
    <nav>
      <a
        href="/about"
        onMouseEnter={handleAboutHover.handleMouseEnter}
        onMouseLeave={handleAboutHover.handleMouseLeave}
      >
        ì†Œê°œ
      </a>
    </nav>
  );
}
```

### ì£¼ì˜ì‚¬í•­

ê³¼ë„í•œ ë¶„í• ì€ ë¹„íš¨ìœ¨ ì ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ë§¤ìš° ì‘ì€ ì—¬ëŸ¬ íŒŒì¼(ì²­í¬)ë¡œ ë¶„í• í•˜ë©´, ë¸Œë¼ìš°ì €ê°€ ë‹¤ìš´ë¡œë“œí•´ì•¼ í•  íŒŒì¼ì˜ ìˆ˜ê°€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.

ëŒ€ë¶€ë¶„ì˜ ë¸Œë¼ìš°ì €ëŠ” í•œ ë²ˆì— ë™ì¼í•œ ë„ë©”ì¸ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆëŠ” **ë™ì‹œ ìš”ì²­ ìˆ˜ë¥¼ ì œí•œ**í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì´ ì œí•œì€ 6ê°œì—ì„œ 8ê°œ ì‚¬ì´ì…ë‹ˆë‹¤. ë§Œì•½ ë¶„í• ëœ ì²­í¬ íŒŒì¼ì´ ì´ ì œí•œë³´ë‹¤ ë§ì•„ì§€ë©´, ì¼ë¶€ ìš”ì²­ì€ ì•ì„  ìš”ì²­ì´ ì™„ë£Œë  ë•Œê¹Œì§€ **ëŒ€ê¸°**í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìš´ë¡œë“œ ë³‘ëª© í˜„ìƒì„ ì´ˆë˜í•˜ì—¬ í˜ì´ì§€ ë¡œë”©ì„ ì§€ì—°ì‹œí‚µë‹ˆë‹¤.

### 2. Tree Shaking ìµœì í™”

íŠ¸ë¦¬ ì…°ì´í‚¹ì€ ë‚˜ë¬´ë¥¼ í”ë“¤ì–´ ì£½ì€ ìì„ ë–¨ì–´ëœ¨ë¦¬ëŠ” ê²ƒì— ë¹„ìœ ë©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œë¥¼ ì œê±°í•˜ëŠ” ê²ƒì€ ë²ˆë“¤ í¬ê¸°ì™€ ë¡œë”© ì†ë„ë¥¼ ê°œì„ í•©ë‹ˆë‹¤.

**ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ì œê±° (í•µì‹¬ ìŠ¤ë‹ˆí«)**:

```javascript
// math.js â€” ê°œë³„ export í•„ìˆ˜ (default í†µí•© export ì§€ì–‘)
export const add = (a, b) => a + b;
export const multiply = (a, b) => a * b;

// ì‚¬ìš©ì²˜ â€” í•„ìš”í•œ ê²ƒë§Œ import
import { add } from "./math.js";
console.log(add(2, 3));
```

**Webpack ì„¤ì • (ê°„ë‹¨ ë²„ì „)**:

```javascript
// webpack.config.js
module.exports = {
  mode: "production",
  optimization: { usedExports: true, sideEffects: false, minimize: true },
};
```

**í•µì‹¬ í¬ì¸íŠ¸**

- ESMì˜ named exportë§Œ Tree Shaking ëŒ€ìƒì´ ë˜ê¸° ì‰¬ì›€
- `sideEffects: false`ëŠ” CSS-in-JS, í´ë¦¬í•„ ë“± ë¶€ì‘ìš© ëª¨ë“ˆì— ì£¼ì˜(í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ í•„ìš”)
- ë™ì  require/namespace importëŠ” ì œê±° ë¶ˆê°€ â†’ êµ¬ì¡° ê°œì„ 

### 3. Minification ìµœì í™”

**JavaScript ì½”ë“œ ì••ì¶• (í•µì‹¬ ìŠ¤ë‹ˆí«)**

```bash
npx terser src/app.js -c -m -o dist/app.min.js
```

**í•µì‹¬ í¬ì¸íŠ¸**

- `-c`(compress), `-m`(mangle)ë¡œ í¬ê¸° ìµœì†Œí™”, Sourcemapì€ ë°°í¬ ì±„ë„ì— ë”°ë¼ ë¶„ë¦¬ ì œê³µ
- ë¡œê¹… ì œê±°ëŠ” ë¹Œë“œ íƒ€ê¹ƒ/í™˜ê²½ë³€ìˆ˜ë¡œ ì œì–´(ë¬´ì¡°ê±´ drop_console ì§€ì–‘)

### 4. Vendor Chunk ìµœì í™”

**ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œ ë¶„ë¦¬ (ê°„ë‹¨ ë²„ì „)**

```javascript
// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: "all",
      minSize: 20000,
      maxAsyncRequests: 30,
      maxInitialRequests: 30,
    },
  },
};
```

**í•µì‹¬ í¬ì¸íŠ¸**

- í”„ë ˆì„ì›Œí¬/ëŒ€í˜• ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì²­í¬ë¡œ ë¶„ë¦¬í•´ ìºì‹œ íˆíŠ¸ìœ¨â†‘, ì•± ì½”ë“œ ë³€ê²½ ì‹œ ì¬ë‹¤ìš´ë¡œë“œ ìµœì†Œí™”
- ë„ˆë¬´ ì„¸ë¶„í™”ëœ cacheGroupì€ ìš”ì²­ ìˆ˜â†‘ â†’ ê· í˜•ì  ì°¾ê¸°

**ë™ì  Import (í•µì‹¬ ìŠ¤ë‹ˆí«)**

```javascript
// ì¡°ê±´ë¶€ ë¡œë”© â€” ê²½ë¡œ ê¸°ì¤€ ìŠ¤í”Œë¦¬íŒ…
if (location.pathname.startsWith("/dashboard")) {
  const { init } = await import("./pages/dashboard.js");
  init();
}
```

**í•µì‹¬ í¬ì¸íŠ¸**

- ë¼ìš°íŠ¸/ë·° ë‹¨ìœ„ ìŠ¤í”Œë¦¬íŒ…ì´ ê¸°ë³¸ ì „ëµ, ìœ„ì ¯/ê·¸ë˜í”„ ë“± ë¬´ê±°ìš´ ì»´í¬ë„ŒíŠ¸ëŠ” ì¶”ê°€ ë¶„ë¦¬
- ë™ì  importëŠ” ì£¼ì„ íŒíŠ¸ë¡œ ì²­í¬ëª… ì œì–´ ê°€ëŠ¥: `import(/* webpackChunkName: "chart" */ './Chart')`
