# ⭐ 메멘토 (Memento) ⭐

## 개요

메멘토(Memento) 패턴은 **객체의 상태를 저장하고, 나중에 그 상태로 되돌릴 수 있게 하는** 행동 패턴입니다. 객체 내부의 상태를 외부에 노출하지 않고도 특정 시점의 상태를 '스냅샷'으로 저장하고 복원할 수 있습니다.

커맨드 패턴은 요청을 객체로 캡슐화 하여 요청을 위임하고 실행 시점을 제어합니다.

메멘토 패턴은 상태를 객체로 캡슐화 하여 스냅샷을 만들고 상태 저장/복원 관리에 용이합니다.

## 프론트엔드 활용 아이디어

- **실행 취소/다시 실행**: 에디터, 그림판
- **폼 데이터**: 임시 저장, 자동 복구
- **상태 히스토리**: 사용자 액션 기록, 브라우저 뒤로가기

## 백엔드/전체 활용 아이디어

- **데이터베이스 트랜잭션**: 롤백/커밋, 체크포인트
- **워크플로우**: 단계별 상태 저장, 진행 상황 복구

## 구조

- Originator(상태 생성/복원)
- Memento(스냅샷 객체)
- Caretaker(스냅샷 관리자)

## 구현 팁

- 메멘토 객체는 불변으로 만들어 상태 변경 방지
- 메모리 효율을 위해 스냅샷 수 제한 및 압축 고려

## JavaScript 예제

```javascript
// 원본 객체: 상태를 생성하고 저장
class TextEditor {
  constructor() {
    this.content = "";
  }

  // 상태 변경 메서드
  addContent(text) {
    this.content += text;
    console.log(`[원본 객체] 내용 추가됨: "${this.content}"`);
  }

  // 현재 상태를 메멘토로 저장
  createMemento() {
    return new EditorMemento(this.content);
  }

  // 메멘토에서 상태 복원
  restoreMemento(memento) {
    this.content = memento.getState();
    console.log(`[원본 객체] 상태 복원됨: "${this.content}"`);
  }
}

---

// 메멘토: 원본 객체의 상태를 저장
class EditorMemento {
  constructor(content) {
    this.content = content;
  }

  // 상태를 반환하는 메서드 (원본 객체만 접근 가능)
  getState() {
    return this.content;
  }
}

---

// 관리자: 메멘토를 저장/관리
class History {
  constructor() {
    this.history = [];
  }

  // 메멘토 저장
  save(memento) {
    this.history.push(memento);
  }

  // 마지막 메멘토 복원
  undo() {
    if (this.history.length > 1) {
      this.history.pop();
      return this.history[this.history.length - 1];
    }
    return null; // 되돌릴 상태가 없음
  }
}

---

const editor = new TextEditor();
const history = new History();

// 1단계: 내용 추가 및 상태 저장
editor.addContent("안녕하세요. ");
history.save(editor.createMemento()); // 메멘토 저장

// 2단계: 내용 추가 및 상태 저장
editor.addContent("메멘토 패턴입니다. ");
history.save(editor.createMemento()); // 메멘토 저장

console.log("\n현재 상태:");
console.log(editor.content);

// 4단계: '실행 취소' (undo)
console.log("\n--- 실행 취소 (Undo) ---");
const lastMemento = history.undo();
if (lastMemento) {
  editor.restoreMemento(lastMemento);
} else {
  console.log("더 이상 되돌릴 작업이 없습니다.");
}
```
