# 조인 (JOIN)

데이터베이스에서 '조인(JOIN)'은 둘 이상의 테이블(릴레이션)을 공통된 컬럼(속성)을 기준으로 연결하여 하나의 결과 테이블로 만드는 연산입니다. 관계형 데이터베이스의 핵심 기능 중 하나로, 여러 테이블에 분산되어 있는 관련 데이터를 함께 조회할 때 사용됩니다.

## 1. 조인의 종류

다양한 종류의 조인이 있으며, 데이터를 결합하는 방식에 따라 결과가 달라집니다.

### 1.1. 내부 조인 (INNER JOIN)

- **개념:** 두 테이블에서 조인 조건에 만족하는(일치하는) 행들만 반환합니다. 양쪽 테이블 모두에 데이터가 존재하는 경우에만 결과에 포함됩니다. 가장 일반적으로 사용되는 조인 유형입니다.
- **키워드:** `INNER JOIN` 또는 단순히 `JOIN` (INNER는 생략 가능)
- **예시:**
  ```sql
  SELECT A.컬럼1, B.컬럼2
  FROM 테이블A A
  INNER JOIN 테이블B B ON A.공통컬럼 = B.공통컬럼;
  ```

### 1.2. 외부 조인 (OUTER JOIN)

외부 조인은 조인 조건에 만족하지 않는 행들도 결과에 포함시키는 조인입니다. `LEFT`, `RIGHT`, `FULL` 세 가지 유형이 있습니다.

#### 1.2.1. 왼쪽 외부 조인 (LEFT OUTER JOIN)

- **개념:** 왼쪽 테이블(`FROM` 절에 명시된 테이블)의 모든 행을 포함하고, 오른쪽 테이블에서는 조인 조건에 만족하는 행만 포함합니다. 오른쪽 테이블에서 일치하는 행이 없으면 `NULL` 값을 채웁니다.
- **키워드:** `LEFT OUTER JOIN` 또는 `LEFT JOIN` (OUTER는 생략 가능)
- **예시:**
  ```sql
  SELECT A.컬럼1, B.컬럼2
  FROM 테이블A A
  LEFT JOIN 테이블B B ON A.공통컬럼 = B.공통컬럼;
  ```

#### 1.2.2. 오른쪽 외부 조인 (RIGHT OUTER JOIN)

- **개념:** 오른쪽 테이블(`JOIN` 절에 명시된 테이블)의 모든 행을 포함하고, 왼쪽 테이블에서는 조인 조건에 만족하는 행만 포함합니다. 왼쪽 테이블에서 일치하는 행이 없으면 `NULL` 값을 채웁니다.
- **키워드:** `RIGHT OUTER JOIN` 또는 `RIGHT JOIN` (OUTER는 생략 가능)
- **예시:**
  ```sql
  SELECT A.컬럼1, B.컬럼2
  FROM 테이블A A
  RIGHT JOIN 테이블B B ON A.공통컬럼 = B.공통컬럼;
  ```

#### 1.2.3. 전체 외부 조인 (FULL OUTER JOIN)

- **개념:** 왼쪽 테이블과 오른쪽 테이블의 모든 행을 포함합니다. 조인 조건에 만족하는 행은 연결하고, 만족하지 않는 행은 다른 테이블의 해당 컬럼에 `NULL` 값을 채웁니다. (일부 데이터베이스에서는 지원하지 않을 수 있습니다.)
- **키워드:** `FULL OUTER JOIN` 또는 `FULL JOIN` (OUTER는 생략 가능)
- **예시:**
  ```sql
  SELECT A.컬럼1, B.컬럼2
  FROM 테이블A A
  FULL JOIN 테이블B B ON A.공통컬럼 = B.공통컬럼;
  ```

### 1.3. 교차 조인 (CROSS JOIN)

- **개념:** 두 테이블의 모든 가능한 행 조합(데카르트 곱, Cartesian Product)을 반환합니다. 조인 조건 없이 단순히 두 테이블의 모든 행을 연결합니다.
- **키워드:** `CROSS JOIN`
- **예시:**
  ```sql
  SELECT A.컬럼1, B.컬럼2
  FROM 테이블A A
  CROSS JOIN 테이블B B;
  ```

### 1.4. 셀프 조인 (SELF JOIN)

- **개념:** 동일한 테이블을 두 번 사용하여 스스로 조인하는 것입니다. 테이블 내에서 자신과 관계를 맺는 데이터를 찾을 때 사용됩니다. 별칭(alias)을 사용하여 각 테이블을 구분해야 합니다.
- **예시:**
  ```sql
  SELECT A.사원명, B.사원명 AS 매니저명
  FROM 사원 A
  JOIN 사원 B ON A.매니저ID = B.사원ID;
  ```

## 2. 예제 (SQL)

이전 `키` 파일에서 사용했던 `Students`, `Courses`, `Enrollments` 테이블을 활용하여 조인 예시를 보겠습니다.

```sql
-- Students 테이블
-- student_id | student_name | email
-- -----------|--------------|-------------------
-- 1          | 김철수       | kim@example.com
-- 2          | 박영희       | park@example.com

-- Courses 테이블
-- course_id | course_name
-- -----------|-------------------
-- 101        | 데이터베이스 개론
-- 102        | 자료구조

-- Enrollments 테이블
-- enrollment_id | student_id | course_id | enrollment_date
-- --------------|------------|-----------|-------------------
-- 1             | 1          | 101       | 2023-03-01
-- 2             | 1          | 102       | 2023-03-01
-- 3             | 2          | 101       | 2023-03-01

-- INNER JOIN (학생들이 수강한 과목 정보)
SELECT S.student_name, C.course_name
FROM Students S
INNER JOIN Enrollments E ON S.student_id = E.student_id
INNER JOIN Courses C ON E.course_id = C.course_id;
-- 결과:
-- student_name | course_name
-- -------------|-------------------
-- 김철수       | 데이터베이스 개론
-- 김철수       | 자료구조
-- 박영희       | 데이터베이스 개론

-- LEFT JOIN (모든 학생과 그들이 수강한 과목 정보, 수강하지 않은 학생도 포함)
-- 새로운 학생 '최지수'를 추가하여 예시를 보강합니다.
-- INSERT INTO Students (student_id, student_name, email) VALUES (3, '최지수', 'choi@example.com');

SELECT S.student_name, C.course_name
FROM Students S
LEFT JOIN Enrollments E ON S.student_id = E.student_id
LEFT JOIN Courses C ON E.course_id = C.course_id;
-- 결과 (최지수가 추가되었고, 수강 과목이 없으므로 NULL로 표시됩니다):
-- student_name | course_name
-- -------------|-------------------
-- 김철수       | 데이터베이스 개론
-- 김철수       | 자료구조
-- 박영희       | 데이터베이스 개론
-- 최지수       | NULL

-- RIGHT JOIN (모든 과목과 해당 과목을 수강한 학생 정보, 수강한 학생이 없는 과목도 포함)
-- 새로운 과목 '인공지능'을 추가하여 예시를 보강합니다.
-- INSERT INTO Courses (course_id, course_name) VALUES (103, '인공지능');

SELECT S.student_name, C.course_name
FROM Students S
RIGHT JOIN Enrollments E ON S.student_id = E.student_id
RIGHT JOIN Courses C ON E.course_id = C.course_id;
-- 결과 (인공지능 과목을 수강한 학생이 없으므로 NULL로 표시됩니다):
-- student_name | course_name
-- -------------|-------------------
-- 김철수       | 데이터베이스 개론
-- 박영희       | 데이터베이스 개론
-- 김철수       | 자료구조
-- NULL         | 인공지능
```

**코드 설명:**

- `INNER JOIN`은 `Students`, `Enrollments`, `Courses` 세 테이블에서 모두 일치하는 데이터만을 가져와, 학생들이 어떤 과목을 수강했는지 보여줍니다.
- `LEFT JOIN`은 왼쪽 테이블인 `Students`의 모든 학생을 기준으로, 수강 여부에 관계없이 학생 정보를 보여주고, 수강한 과목이 없으면 `NULL`로 표시합니다.
- `RIGHT JOIN`은 오른쪽 테이블인 `Courses`의 모든 과목을 기준으로, 해당 과목을 수강한 학생이 없으면 `NULL`로 표시합니다.
