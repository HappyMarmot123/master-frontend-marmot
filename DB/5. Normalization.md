# 정규화 (Normalization)

데이터베이스 '정규화(Normalization)'는 관계형 데이터베이스의 설계 과정에서 중복을 최소화하고, 데이터의 무결성을 유지하며, 이상 현상(Anomaly)을 방지하기 위해 릴레이션(테이블)을 분해하는 작업입니다. 이는 데이터를 구조적으로 잘 정리하여 효율적인 데이터 저장 및 관리를 가능하게 합니다.

## 1. 정규화의 목적

- **데이터 중복 제거:** 불필요한 데이터의 중복을 제거하여 저장 공간을 효율적으로 사용하고, 데이터 일관성을 유지합니다.
- **이상 현상 방지:** 데이터 삽입(Insert), 삭제(Delete), 갱신(Update) 시 발생할 수 있는 문제점(이상 현상)을 줄입니다.
  - **삽입 이상 (Insertion Anomaly):** 데이터를 삽입할 때 원하지 않는 불필요한 정보까지 함께 삽입해야 하는 경우.
  - **삭제 이상 (Deletion Anomaly):** 특정 데이터를 삭제할 때, 의도하지 않은 다른 중요한 정보까지 함께 삭제되는 경우.
  - **갱신 이상 (Update Anomaly):** 중복된 데이터를 갱신할 때 일부만 갱신되어 데이터 불일치가 발생하는 경우.
- **데이터 무결성 강화:** 데이터의 정확성과 일관성을 높입니다.
- **데이터 구조의 명확성:** 테이블 간의 관계를 명확히 하고, 데이터 모델을 더 이해하기 쉽게 만듭니다.

## 2. 정규형의 종류

정규화는 여러 단계의 정규형(Normal Form)을 통해 이루어집니다. 각 정규형은 이전 정규형의 조건을 만족하면서 추가적인 제약 조건을 적용합니다. 가장 일반적으로 1NF, 2NF, 3NF, BCNF가 사용됩니다.

### 2.1. 제1 정규형 (1NF, First Normal Form)

- **조건:** 릴레이션의 모든 속성 값이 **원자값(Atomic Value)**이어야 합니다. 즉, 하나의 속성에는 단 하나의 값만 저장되어야 하며, 반복되는 그룹(Repeating Group)이나 복합 속성(Composite Attribute)이 없어야 합니다.
- **예시 (비1NF -> 1NF):**
  - 비1NF: `(학생이름, 과목1, 과목2)` -> `(김철수, 수학, 영어)`
  - 1NF: `(학생이름, 과목)` -> `(김철수, 수학), (김철수, 영어)`

### 2.2. 제2 정규형 (2NF, Second Normal Form)

- **조건:** 1NF를 만족하고, 모든 비기본 키 속성이 **완전 함수 종속(Full Functional Dependency)**이어야 합니다. 즉, 기본 키의 부분 집합에 종속되지 않아야 합니다. (기본 키가 단일 속성인 경우에는 1NF를 만족하면 자동으로 2NF를 만족합니다.)
- **예시 (1NF -> 2NF):**
  - 테이블: `(학번, 강좌코드, 학점, 강좌명, 강좌교수)`
  - 기본 키: `(학번, 강좌코드)`
  - 문제: `강좌명`, `강좌교수`는 `강좌코드`에만 종속 (부분 함수 종속)
  - 2NF 분해:
    - `수강` 테이블: `(학번, 강좌코드, 학점)`
    - `강좌` 테이블: `(강좌코드, 강좌명, 강좌교수)`

### 2.3. 제3 정규형 (3NF, Third Normal Form)

- **조건:** 2NF를 만족하고, 모든 비기본 키 속성이 **이행 함수 종속(Transitive Functional Dependency)**이 아니어야 합니다. 즉, 기본 키가 아닌 다른 속성을 통해 간접적으로 기본 키에 종속되는 현상이 없어야 합니다.
- **예시 (2NF -> 3NF):**
  - 테이블: `(주문번호, 고객ID, 고객이름, 고객주소)`
  - 기본 키: `(주문번호)`
  - 문제: `고객이름`, `고객주소`는 `고객ID`에 종속되고, `고객ID`는 `주문번호`에 종속 (이행 함수 종속: `주문번호` -> `고객ID` -> `고객이름, 고객주소`)
  - 3NF 분해:
    - `주문` 테이블: `(주문번호, 고객ID)`
    - `고객` 테이블: `(고객ID, 고객이름, 고객주소)`

### 2.4. BCNF (Boyce-Codd Normal Form)

- **조건:** 3NF를 만족하고, 모든 **결정자(Determinant)**가 후보 키(Candidate Key)이어야 합니다. (결정자: 다른 속성을 결정하는 속성 집합)
- **특징:** 3NF에서 발생할 수 있는 특수한 형태의 이상 현상까지 제거하여 더 엄격한 무결성을 보장합니다. 하지만 항상 가능한 것은 아니며, 때로는 BCNF를 만족시키기 위해 데이터 중복을 허용해야 할 수도 있습니다.

## 3. 반정규화 (Denormalization)

정규화는 데이터 무결성과 일관성을 높이지만, 테이블이 많이 분리되면서 `JOIN` 연산이 많아져 쿼리 성능이 저하될 수 있습니다. 이러한 성능 문제를 해결하기 위해 의도적으로 정규화 원칙을 위반하여 중복을 허용하거나 테이블을 합치는 과정을 **반정규화(Denormalization)**라고 합니다.

- **목적:** 주로 데이터 조회(SELECT) 성능 향상에 중점을 둡니다.
- **주의사항:** 반정규화는 데이터 무결성을 해칠 위험이 있으므로 신중하게 적용해야 합니다.

## 4. 예제 (SQL을 통한 정규화 과정)

다음은 `학생_수강_강좌`라는 하나의 테이블을 3NF까지 정규화하는 과정을 간단히 보여주는 예시입니다.

**비정규형 테이블 (비1NF 또는 0NF):**

| 학번 | 학생이름 | 수강과목     | 과목점수 | 강좌명           | 강좌교수       | 교수연락처           |
| :--- | :------- | :----------- | :------- | :--------------- | :------------- | :------------------- |
| 101  | 김철수   | (수학, 영어) | (90, 85) | 수학개론, 영문법 | 홍길동, 이순신 | (010-1111, 010-2222) |
| 102  | 박영희   | (수학)       | (70)     | 수학개론         | 홍길동         | 010-1111             |

### 4.1. 1NF (원자값 속성)

수강과목과 과목점수가 복합값이므로 분해합니다.

**`학생_수강_강좌_1NF` 테이블:**

| 학번 | 학생이름 | 수강과목 | 과목점수 | 강좌명   | 강좌교수 | 교수연락처 |
| :--- | :------- | :------- | :------- | :------- | :------- | :--------- |
| 101  | 김철수   | 수학     | 90       | 수학개론 | 홍길동   | 010-1111   |
| 101  | 김철수   | 영어     | 85       | 영문법   | 이순신   | 010-2222   |
| 102  | 박영희   | 수학     | 70       | 수학개론 | 홍길동   | 010-1111   |

### 4.2. 2NF (부분 함수 종속 제거)

- 기본 키: `(학번, 수강과목)`
- 문제: `학생이름`은 `학번`에만 종속, `강좌명`, `강좌교수`, `교수연락처`는 `수강과목`(강좌명으로 가정)에만 종속

**`학생` 테이블:**

| 학번 | 학생이름 |
| :--- | :------- |
| 101  | 김철수   |
| 102  | 박영희   |

**`강좌_교수` 테이블:**

| 수강과목 | 강좌명   | 강좌교수 | 교수연락처 |
| :------- | :------- | :------- | :--------- |
| 수학     | 수학개론 | 홍길동   | 010-1111   |
| 영어     | 영문법   | 이순신   | 010-2222   |

**`수강` 테이블:**

| 학번 | 수강과목 | 과목점수 |
| :--- | :------- | :------- |
| 101  | 수학     | 90       |
| 101  | 영어     | 85       |
| 102  | 수학     | 70       |

### 4.3. 3NF (이행 함수 종속 제거)

- `강좌_교수` 테이블에서 `교수연락처`는 `강좌교수`에 종속되고, `강좌교수`는 `수강과목`에 종속 (`수강과목` -> `강좌교수` -> `교수연락처`). 이행 함수 종속 발생.

**`강좌` 테이블:**

| 수강과목 | 강좌명   | 강좌교수 |
| :------- | :------- | :------- |
| 수학     | 수학개론 | 홍길동   |
| 영어     | 영문법   | 이순신   |

**`교수` 테이블:**

| 강좌교수 | 교수연락처 |
| :------- | :--------- |
| 홍길동   | 010-1111   |
| 이순신   | 010-2222   |

(나머지 `학생`, `수강` 테이블은 2NF와 동일)

이처럼 정규화를 통해 데이터 중복을 줄이고 데이터 무결성을 강화할 수 있습니다.
