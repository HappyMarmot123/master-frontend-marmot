## SSG (Static Site Generation)

Next.js에서 **빌드 시점**에 페이지를 미리 렌더링하여 정적인 HTML 파일로 만드는 방식입니다. 한 번 빌드된 페이지는 CDN(콘텐츠 전송 네트워크)에 배포되어 사용자에게 매우 빠르게 제공됩니다.

- **작동 방식**:

  - `next build` 명령을 실행할 때, `getStaticProps` 함수가 포함된 모든 페이지는 서버에서 한 번 실행됩니다.

  - `getStaticProps`에서 가져온 데이터를 기반으로 페이지의 HTML이 생성됩니다.
  - 생성된 HTML과 해당 페이지에 필요한 JSON 데이터는 파일로 저장됩니다.

- **장점**:

  - **매우 빠른 응답 속도**: HTML이 이미 생성되어 CDN에 캐시되므로, 사용자 요청 시 서버를 거치지 않고 즉시 전송됩니다.

  - **우수한 SEO**: 검색 엔진 크롤러가 완전한 HTML 콘텐츠를 쉽게 색인할 수 있습니다.

  - **낮은 서버 부하**: 페이지가 빌드 시점에 생성되므로, 런타임에 서버가 해야 할 작업이 거의 없어 서버 부하가 매우 낮습니다.

- **단점**:

  - **데이터 업데이트의 어려움**: 데이터가 변경될 때마다 애플리케이션을 다시 빌드하고 재배포해야 최신 내용을 반영할 수 있습니다.

  - **빌드 시간**: 페이지 수가 많거나 데이터 페칭에 시간이 오래 걸리면 빌드 시간이 길어질 수 있습니다.

- **주요 용도**: 블로그 게시물, 마케팅 페이지, 문서 페이지 등 데이터가 자주 변경되지 않거나 변경되어도 즉각적인 반영이 중요하지 않은 정적인 콘텐츠에 적합합니다.

## ISR (Incremental Static Regeneration)

SSG의 장점(빠른 응답 속도, SEO)을 유지하면서도 데이터 업데이트의 어려움이라는 단점을 보완하기 위해 도입된 방식입니다. ISR은 페이지를 정적으로 생성하되, 특정 주기로 페이지를 **백그라운드에서 재생성**하여 최신 데이터를 반영할 수 있도록 합니다.

- **ISR 작동 방식**:
  ISR은 `getStaticProps` 함수에서 `revalidate` 옵션을 사용하여 구현합니다.

  1.  **최초 요청**: 사용자가 페이지에 처음 요청을 보내거나, `revalidate` 주기가 만료되지 않은 상태에서 요청을 보내면, Next.js는 이전에 캐시된 정적 페이지를 즉시 응답으로 보냅니다.

  2.  **백그라운드 재생성**: `revalidate` 옵션에 설정된 시간이 지나고 새로운 요청이 들어오면, Next.js는 즉시 기존의 캐시된 페이지를 제공하면서 동시에 **백그라운드에서 페이지 재생성**을 시작합니다.

  3.  **새로운 페이지 제공**: 백그라운드에서 페이지 재생성이 완료되면, Next.js는 새로운 정적 페이지로 캐시를 업데이트합니다. 이후 요청부터는 이 새롭게 업데이트된 페이지를 제공합니다.

  이러한 방식으로 사용자는 항상 빠르게 페이지를 받아볼 수 있으며, `revalidate` 옵션을 통해 데이터가가 주기적으로 업데이트되므로 항상 최신 콘텐츠를 유지할 수 있습니다.

- **사용 시나리오**: 블로그 게시물, 제품 목록, 뉴스 기사 등 데이터가 비교적 자주 업데이트되지만, 모든 요청마다 서버에서 렌더링할 필요는 없는 콘텐츠에 특히 유용합니다.

## ISR 구현 예시

`pages` 디렉토리(Pages Router)에서 `getStaticProps`와 `getStaticPaths`를 사용하는 예시입니다. App Router에서는 `fetch` API의 `revalidate` 옵션을 통해 유사하게 구현할 수 있습니다.

```jsx
// pages/posts/[id].js
import { getPostById, getAllPostIds } from "../../lib/posts";

export async function getStaticPaths() {
  const paths = getAllPostIds();
  return {
    paths,
    fallback: "blocking", // 'blocking' 또는 true/false (true 사용 시 로딩 상태 처리 필요)
  };
}

export async function getStaticProps({ params }) {
  const post = await getPostById(params.id);
  return {
    props: {
      post,
    },
    revalidate: 60, // 60초마다 페이지 재생성 시도
  };
}

function Post({ post }) {
  return (
    <div>
      <h1>{post.title}</h1>
      <p>{post.content}</p>
    </div>
  );
}

export default Post;
```

위 예시에서 `revalidate: 60`은 페이지가 60초마다 백그라운드에서 재생성될 수 있음을 의미합니다. 첫 요청 이후 60초가 지나면 다음 요청 시 기존 페이지를 보여주고 백그라운드에서 새로운 페이지를 생성하여 캐시를 업데이트합니다.
