# DataSync & Storage Gateway

## 개요
AWS DataSync와 Storage Gateway는 온프레미스와 AWS 클라우드 간 데이터 전송 및 통합을 위한 하이브리드 스토리지 솔루션입니다.

## AWS DataSync

### DataSync란?
**정의**: 온프레미스 스토리지와 AWS 스토리지 서비스 간 빠른 데이터 전송 서비스

**특징**:
- 빠른 데이터 전송
- 자동화된 동기화
- 네트워크 최적화
- 증분 복사

**작동 원리**:
```
온프레미스 스토리지
  ↓ (DataSync 에이전트)
AWS 백본 네트워크
  ↓
AWS 스토리지 (S3, EFS, FSx)
```

### 주요 기능

#### 1. 빠른 전송
**특징**:
- 멀티 스레드 전송
- 네트워크 최적화
- 압축 및 암호화

**성능**:
- 최대 10Gbps 전송 속도
- 네트워크 대역폭 활용 최적화

#### 2. 자동화
**특징**:
- 스케줄링된 동기화
- 이벤트 기반 동기화
- 자동 재시도

#### 3. 데이터 검증
**특징**:
- 전송 후 데이터 무결성 검증
- 체크섬 확인
- 오류 자동 감지

### 사용 사례

#### 시나리오 1: 데이터 마이그레이션
```
온프레미스 파일 서버
  ↓ (DataSync)
S3 (데이터 레이크)
```

#### 시나리오 2: 백업 및 복제
```
온프레미스 백업
  ↓ (정기 동기화)
S3 (클라우드 백업)
```

#### 시나리오 3: 하이브리드 파일 시스템
```
온프레미스 파일 서버
  ↓ (동기화)
EFS (클라우드 파일 시스템)
```

## AWS Storage Gateway

### Storage Gateway란?
**정의**: 온프레미스 환경과 AWS 클라우드 스토리지 간 브리지 역할

**특징**:
- 하이브리드 클라우드 스토리지
- 기존 애플리케이션과 통합
- 낮은 지연 시간
- 자동 확장

### Gateway 유형

#### 1. File Gateway
**정의**: S3를 파일 시스템으로 노출

**특징**:
- NFS/SMB 프로토콜 지원
- S3에 직접 저장
- 로컬 캐싱

**사용 사례**:
- 파일 서버 마이그레이션
- 파일 공유
- 백업 및 아카이브

**작동 원리**:
```
온프레미스 애플리케이션
  ↓ (NFS/SMB)
File Gateway
  ↓ (자동 업로드)
S3
```

#### 2. Volume Gateway
**정의**: EBS 볼륨을 온프레미스에 노출

**유형**:

**Cached Volumes**:
- 자주 사용하는 데이터만 로컬 캐싱
- 나머지는 S3에 저장
- 비용 최적화

**Stored Volumes**:
- 모든 데이터를 로컬에 저장
- S3에 비동기 백업
- 낮은 지연 시간

**사용 사례**:
- 온프레미스 백업
- 재해 복구
- 데이터 마이그레이션

**작동 원리**:
```
온프레미스 애플리케이션
  ↓ (iSCSI)
Volume Gateway
  ↓ (스냅샷)
S3 (EBS 스냅샷)
```

#### 3. Tape Gateway (VTL)
**정의**: S3를 가상 테이프 라이브러리로 노출

**특징**:
- 기존 백업 소프트웨어와 호환
- 테이프 드라이브 에뮬레이션
- 자동으로 S3 Glacier로 전환

**사용 사례**:
- 레거시 백업 시스템
- 테이프 백업 대체
- 규정 준수

**작동 원리**:
```
백업 소프트웨어
  ↓ (테이프 명령)
Tape Gateway (VTL)
  ↓ (가상 테이프)
S3 → S3 Glacier
```

## DataSync vs Storage Gateway 비교

### 비교표

| 항목 | DataSync | Storage Gateway |
|------|----------|-----------------|
| **목적** | 데이터 전송 및 동기화 | 하이브리드 스토리지 브리지 |
| **프로토콜** | 네이티브 AWS | NFS/SMB/iSCSI/VTL |
| **사용 사례** | 일회성 마이그레이션, 동기화 | 지속적인 하이브리드 접근 |
| **설치** | 에이전트 설치 | 게이트웨이 VM/하드웨어 |
| **비용** | 데이터 전송 기반 | 게이트웨이 시간당 + 스토리지 |

### 선택 기준

#### DataSync를 선택하는 경우
- 일회성 데이터 마이그레이션
- 정기적인 동기화
- 빠른 전송 필요
- 네이티브 AWS 서비스 사용

#### Storage Gateway를 선택하는 경우
- 기존 애플리케이션과 통합
- 지속적인 하이브리드 접근
- 레거시 시스템 지원
- 파일 시스템 인터페이스 필요

## 하이브리드 아키텍처 예시

### 예시 1: 파일 서버 마이그레이션
```
온프레미스 파일 서버
  ↓ (DataSync로 초기 마이그레이션)
S3
  ↓ (File Gateway로 접근)
온프레미스 사용자 (기존 애플리케이션)
```

### 예시 2: 백업 및 복제
```
온프레미스 서버
  ↓ (Volume Gateway)
S3 (EBS 스냅샷)
  ↓ (다른 리전으로 복제)
DR 환경
```

### 예시 3: 데이터 레이크 구축
```
온프레미스 데이터 소스
  ├── DataSync → S3 (데이터 레이크)
  └── File Gateway → S3 (실시간 접근)
```

## 모범 사례

### 1. 네트워크 최적화
- Direct Connect 사용 (대량 전송)
- 네트워크 대역폭 확보
- 전송 시간대 최적화

### 2. 데이터 검증
- 전송 후 무결성 확인
- 체크섬 검증
- 오류 모니터링

### 3. 비용 최적화
- 필요한 만큼만 전송
- 압축 활용
- 적절한 스토리지 클래스 선택

### 4. 보안
- 전송 중 암호화
- 저장 시 암호화
- IAM 권한 제어

## 관련 서비스

### S3
- 데이터 저장
- 아카이브

### EFS
- 파일 시스템
- 공유 스토리지

### Direct Connect
- 전용 네트워크 연결
- 빠른 전송

## 참고 자료
- [DataSync 공식 문서](https://docs.aws.amazon.com/datasync/)
- [Storage Gateway 공식 문서](https://docs.aws.amazon.com/storagegateway/)
- [하이브리드 클라우드](https://aws.amazon.com/hybrid/)

