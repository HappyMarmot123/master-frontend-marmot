# Aurora

## 개요
Amazon Aurora는 MySQL 및 PostgreSQL과 호환되는 관계형 데이터베이스 엔진으로, 클라우드를 위해 구축된 고성능 데이터베이스입니다. RDS보다 높은 성능과 가용성을 제공합니다.

## 핵심 개념

### Aurora란?
**정의**: MySQL 및 PostgreSQL과 호환되는 고성능 관계형 데이터베이스

**특징**:
- **높은 성능**: RDS보다 최대 5배 빠른 성능
- **높은 가용성**: 자동 장애 조치 (30초 이내)
- **자동 확장**: 스토리지 자동 확장 (최대 128TB)
- **높은 내구성**: 6개 복사본, 3개 AZ에 분산

**작동 원리**:
```
애플리케이션
  ↓
Aurora 클러스터
  ├── Writer 인스턴스 (Primary)
  ├── Reader 인스턴스 1 (Read Replica)
  ├── Reader 인스턴스 2 (Read Replica)
  └── 스토리지 클러스터 (6개 복사본, 3개 AZ)
```

## Aurora 아키텍처

### 스토리지 아키텍처
**정의**: 계산과 스토리지가 분리된 아키텍처

**구조**:
```
Aurora 인스턴스 (계산)
  ↓
스토리지 클러스터 (스토리지)
  ├── 복사본 1 (AZ A)
  ├── 복사본 2 (AZ A)
  ├── 복사본 3 (AZ B)
  ├── 복사본 4 (AZ B)
  ├── 복사본 5 (AZ C)
  └── 복사본 6 (AZ C)
```

**특징**:
- **6개 복사본**: 데이터를 6개 복사본에 저장
- **3개 AZ 분산**: 각 AZ에 2개씩 분산
- **쿼럼 기반 쓰기**: 4개 복사본에 쓰기 성공 시 커밋
- **쿼럼 기반 읽기**: 3개 복사본에서 읽기

**장점**:
- 높은 내구성 (11개 9)
- 빠른 복제 (스토리지 레벨)
- 자동 복구

### 인스턴스 구성

#### Writer 인스턴스 (Primary)
**정의**: 읽기/쓰기를 모두 처리하는 인스턴스

**특징**:
- 단일 Writer 인스턴스
- 모든 쓰기 작업 처리
- 읽기 작업도 처리 가능

#### Reader 인스턴스 (Read Replica)
**정의**: 읽기 전용 복제본

**특징**:
- 최대 15개의 Reader 인스턴스
- 읽기 작업만 처리
- 자동 장애 조치 가능

**장점**:
- 읽기 성능 향상
- 읽기 부하 분산
- 고가용성

## Aurora 성능

### 성능 특징

#### 1. 높은 처리량
**특징**:
- RDS보다 최대 5배 빠른 성능
- 높은 IOPS
- 낮은 지연 시간

**원인**:
- 스토리지 레벨 복제
- 로그 구조 스토리지
- 병렬 처리

#### 2. 자동 확장
**스토리지 확장**:
- 자동으로 10GB씩 확장
- 최대 128TB까지 확장
- 수동 개입 불필요

**성능 확장**:
- 인스턴스 크기 조정
- Reader 인스턴스 추가

#### 3. 빠른 복제
**특징**:
- 스토리지 레벨 복제
- 밀리초 단위 복제 지연
- RDS보다 빠른 복제

### 성능 최적화

#### 1. 읽기 전용 복제본
**목적**: 읽기 성능 향상

**구현**:
- 여러 Reader 인스턴스 생성
- 읽기 요청을 Reader로 라우팅
- Writer는 쓰기만 처리

**예시**:
```
Writer (1개)
  ├── 쓰기 요청 처리
  └── 읽기 요청도 처리 가능

Reader (5개)
  └── 읽기 요청만 처리

→ 읽기 처리량 5배 증가
```

#### 2. 엔드포인트 최적화
**Writer 엔드포인트**:
- 쓰기 요청용
- 항상 Writer 인스턴스로 라우팅

**Reader 엔드포인트**:
- 읽기 요청용
- 여러 Reader 인스턴스에 로드 밸런싱

**커스텀 엔드포인트**:
- 특정 Reader 인스턴스 그룹 지정
- 특정 워크로드용

## Aurora 유형

### Aurora MySQL
**정의**: MySQL과 호환되는 Aurora

**특징**:
- MySQL 5.7, 8.0 호환
- MySQL 도구 및 드라이버 사용 가능
- MySQL보다 높은 성능

**사용 사례**:
- MySQL 애플리케이션 마이그레이션
- 높은 성능이 필요한 MySQL 워크로드

### Aurora PostgreSQL
**정의**: PostgreSQL과 호환되는 Aurora

**특징**:
- PostgreSQL 11, 12, 13, 14, 15 호환
- PostgreSQL 확장 지원
- PostgreSQL보다 높은 성능

**사용 사례**:
- PostgreSQL 애플리케이션 마이그레이션
- 복잡한 쿼리가 많은 워크로드

### Aurora Serverless v2
**정의**: 자동으로 확장되는 Aurora

**특징**:
- 자동 스케일링 (초 단위)
- 최소/최대 ACU 설정
- 비용 효율적

**사용 사례**:
- 가변 트래픽
- 개발/테스트 환경
- 비용 최적화

## Aurora vs RDS

### 성능 비교

| 항목 | RDS | Aurora |
|------|-----|--------|
| **성능** | 기준 | 최대 5배 빠름 |
| **복제** | 인스턴스 레벨 | 스토리지 레벨 |
| **복제 지연** | 수초 | 밀리초 |
| **읽기 복제본** | 최대 5개 | 최대 15개 |
| **스토리지 확장** | 수동 | 자동 (최대 128TB) |
| **장애 조치** | 60-120초 | 30초 이내 |

### 비용 비교
- **Aurora**: RDS보다 약 20% 높음
- **성능 대비**: 비용 효율적

### 선택 기준

#### Aurora를 선택하는 경우
- 높은 성능 필요
- 높은 가용성 필요
- 자동 확장 필요
- 빠른 복제 필요

#### RDS를 선택하는 경우
- 비용 최적화
- 간단한 구성
- 특정 기능 필요 (Aurora 미지원)

## Aurora 고가용성

### 자동 장애 조치
**과정**:
```
1. Writer 인스턴스 장애 감지
2. Reader 인스턴스 중 하나를 Writer로 승격
3. 엔드포인트 자동 업데이트
4. 애플리케이션 자동 재연결
5. 서비스 복구 (30초 이내)
```

**특징**:
- 자동 감지 및 복구
- 애플리케이션 변경 최소
- 빠른 복구 시간

### 다중 리전 배포
**구조**:
```
리전 A (서울)
  ├── Writer
  └── Reader

리전 B (도쿄)
  └── Global Database (비동기 복제)
```

**특징**:
- 리전 간 복제
- 재해 복구
- 지리적 분산

## Aurora 백업 및 복원

### 자동 백업
**특징**:
- 백업 기간: 최대 35일
- Point-in-Time Recovery 지원
- 백업 윈도우 설정 가능

### 스냅샷
**특징**:
- 수동 스냅샷 생성
- 다른 리전으로 복사
- 클론 생성 가능

### 클론
**정의**: 기존 클러스터의 빠른 복사본

**특징**:
- 스토리지 스냅샷 기반
- 빠른 생성 (분 단위)
- 독립적인 클러스터

**사용 사례**:
- 개발/테스트 환경
- 보고서 생성
- 실험

## 모범 사례

### 1. 읽기 성능 최적화
- 여러 Reader 인스턴스 사용
- Reader 엔드포인트 사용
- 읽기/쓰기 분리

### 2. 고가용성
- 여러 AZ에 배치
- 자동 장애 조치 활성화
- 모니터링 및 알람

### 3. 성능 모니터링
- CloudWatch 지표 모니터링
- Performance Insights 사용
- 느린 쿼리 분석

### 4. 비용 최적화
- 적절한 인스턴스 크기 선택
- 불필요한 Reader 인스턴스 제거
- Serverless v2 고려

## 관련 서비스

### RDS Proxy
- 연결 풀링
- 장애 조치
- Aurora와 통합

### ElastiCache
- 읽기 성능 향상
- 데이터베이스 부하 감소

### CloudWatch
- 모니터링
- 성능 지표

## 참고 자료
- [Aurora 공식 문서](https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/)
- [Aurora 성능 최적화](https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.BestPractices.html)

