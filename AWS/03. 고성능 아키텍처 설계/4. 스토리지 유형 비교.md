# 스토리지 유형 비교

## 개요
AWS는 객체 스토리지(S3), 파일 스토리지(EFS), 블록 스토리지(EBS) 세 가지 주요 스토리지 유형을 제공합니다. 각 유형은 다른 사용 사례와 성능 특성을 가집니다.

## 스토리지 유형 개요

### 1. 객체 스토리지 (S3)
**정의**: 데이터를 객체 단위로 저장하는 스토리지

**특징**:
- HTTP/HTTPS API로 접근
- 플랫한 네임스페이스 (버킷/객체)
- 메타데이터 포함
- 무제한 확장

**접근 방식**:
```
애플리케이션
  ↓ (HTTP API)
S3 버킷
  └── 객체 (키-값 쌍)
```

### 2. 파일 스토리지 (EFS)
**정의**: 파일과 디렉토리 계층 구조로 데이터를 저장하는 스토리지

**특징**:
- NFS 프로토콜로 접근
- 디렉토리 구조
- 여러 인스턴스 동시 접근
- 페타바이트 규모

**접근 방식**:
```
EC2 인스턴스
  ↓ (NFS 마운트)
EFS 파일 시스템
  └── /home/user/file.txt
```

### 3. 블록 스토리지 (EBS)
**정의**: 고정 크기의 블록 단위로 데이터를 저장하는 스토리지

**특징**:
- 블록 디바이스로 접근
- 파일 시스템 필요
- 단일 인스턴스 전용
- 낮은 지연 시간

**접근 방식**:
```
EC2 인스턴스
  ↓ (블록 디바이스)
EBS 볼륨
  ↓ (파일 시스템 마운트)
/var/data
```

## 상세 비교

### 접근 방식

| 항목 | S3 | EFS | EBS |
|------|----|-----|-----|
| **프로토콜** | HTTP/HTTPS (REST API) | NFSv4 | 블록 디바이스 |
| **접근 방법** | API 호출 | 파일 시스템 마운트 | 블록 디바이스 마운트 |
| **동시 접근** | 무제한 | 여러 인스턴스 | 단일 인스턴스 |
| **예시** | `aws s3 cp file.txt s3://bucket/` | `cp file.txt /mnt/efs/` | `cp file.txt /var/data/` |

### 확장성

| 항목 | S3 | EFS | EBS |
|------|----|-----|-----|
| **최대 크기** | 무제한 | 페타바이트 | 볼륨당 16TB |
| **확장 방식** | 자동 | 자동 | 수동 (볼륨 크기 조정) |
| **확장 속도** | 즉시 | 즉시 | 볼륨 수정 필요 |

### 성능 특성

#### 지연 시간
- **S3**: 높음 (수십~수백 ms)
  - HTTP 요청 오버헤드
  - 네트워크를 통한 접근
- **EFS**: 낮음 (수 ms)
  - 로컬 네트워크 접근
  - NFS 프로토콜
- **EBS**: 매우 낮음 (<1ms)
  - 직접 연결
  - 블록 레벨 접근

#### 처리량
- **S3**: 높음 (멀티파트 업로드 시)
  - Transfer Acceleration 활용 가능
- **EFS**: 중간~높음
  - 버스트 모드: 파일 시스템 크기에 비례
  - 프로비저닝 모드: 설정한 처리량
- **EBS**: 볼륨 유형에 따라 다름
  - gp3: 최대 1,000 MB/s
  - io2: 최대 4,000 MB/s
  - st1: 500 MB/s

#### IOPS
- **S3**: IOPS 개념 없음 (객체 단위)
- **EFS**: 파일 시스템 크기에 비례
- **EBS**: 볼륨 유형에 따라 다름
  - gp3: 3,000-16,000 IOPS
  - io2: 최대 256,000 IOPS

### 내구성 및 가용성

| 항목 | S3 | EFS | EBS |
|------|----|-----|-----|
| **내구성** | 99.999999999% (11개 9) | 99.999999% | 99.8-99.9% |
| **가용성** | 99.99% | 99.99% | 단일 AZ (Multi-AZ 옵션 없음) |
| **복제** | 자동 (여러 AZ) | 자동 (여러 AZ) | 스냅샷 수동 복사 |

### 비용

#### 저장 비용 (GB당 월 비용, 예시)
- **S3 Standard**: $0.023
- **EFS Standard**: $0.30
- **EBS gp3**: $0.08

#### 특징
- **S3**: 가장 저렴, 스토리지 클래스별 차등
- **EFS**: 가장 비쌈, 공유 파일 시스템 특성
- **EBS**: 중간, 볼륨 유형별 차등

## 사용 사례별 선택

### 웹사이트 정적 파일
**선택**: S3
**이유**:
- HTTP 접근
- 무제한 확장
- 낮은 비용
- CloudFront와 통합

### 데이터베이스 스토리지
**선택**: EBS (io1/io2)
**이유**:
- 높은 IOPS
- 낮은 지연 시간
- 일관된 성능
- 단일 인스턴스 전용

### 공유 파일 시스템
**선택**: EFS
**이유**:
- 여러 인스턴스 동시 접근
- NFS 프로토콜
- 자동 확장
- 공유 필요

### 백업 및 아카이브
**선택**: S3
**이유**:
- 낮은 비용
- 높은 내구성
- 장기 보관
- 수명 주기 관리

### 빅 데이터 처리
**선택**: EBS (st1) 또는 S3
**이유**:
- **EBS st1**: 높은 처리량, 순차 읽기/쓰기
- **S3**: 무제한 확장, 분석 도구 통합

### 홈 디렉토리
**선택**: EFS
**이유**:
- 여러 사용자 접근
- 파일 시스템 인터페이스
- 공유 필요

## 하이브리드 스토리지 솔루션

### Storage Gateway
**정의**: 온프레미스와 AWS 클라우드 간 스토리지 브리지

**유형**:

1. **File Gateway**
   - S3를 파일 시스템으로 노출
   - NFS/SMB 프로토콜 지원
   - 온프레미스 → S3 마이그레이션

2. **Volume Gateway**
   - EBS 볼륨을 온프레미스에 노출
   - iSCSI 프로토콜
   - 온프레미스 백업 → S3

3. **Tape Gateway**
   - S3를 테이프 라이브러리로 노출
   - VTL (Virtual Tape Library)
   - 레거시 백업 시스템 통합

### DataSync
**정의**: 온프레미스와 AWS 간 데이터 전송 서비스

**특징**:
- 빠른 데이터 전송
- 자동화된 동기화
- 네트워크 최적화
- 증분 복사

**사용 사례**:
- 온프레미스 → S3 마이그레이션
- 정기적인 데이터 동기화
- 백업 및 복제

### Transfer Family
**정의**: 파일 전송 프로토콜 지원 서비스

**지원 프로토콜**:
- SFTP (SSH File Transfer Protocol)
- FTPS (FTP over SSL)
- FTP

**사용 사례**:
- 외부 파트너와 파일 교환
- 레거시 시스템 통합
- 자동화된 파일 전송

## 실제 아키텍처 예시

### 예시 1: 웹 애플리케이션
```
CloudFront
  ↓
S3 (정적 파일: 이미지, CSS, JS)
  ↓
ALB
  ↓
EC2 (애플리케이션)
  ├── EBS (애플리케이션 로그)
  └── EFS (공유 설정 파일)
  ↓
RDS (데이터베이스)
  └── EBS (데이터베이스 스토리지)
```

### 예시 2: 데이터 분석 파이프라인
```
데이터 수집
  ↓
S3 (원본 데이터 저장)
  ↓
EMR (데이터 처리)
  ├── EBS st1 (처리 중 데이터)
  └── EFS (중간 결과 공유)
  ↓
S3 (처리된 데이터)
  ↓
데이터 분석
```

### 예시 3: 콘텐츠 관리 시스템
```
웹 서버들 (Auto Scaling)
  ├── EFS (이미지, 문서 공유)
  └── EBS (애플리케이션 코드)
  ↓
RDS (메타데이터)
  └── EBS (데이터베이스)
  ↓
S3 (백업)
```

## 선택 의사결정 트리

```
데이터 저장 필요
  ↓
여러 인스턴스가 동시 접근?
  ├── 예 → EFS (파일 스토리지)
  └── 아니오 ↓
      HTTP/HTTPS 접근?
      ├── 예 → S3 (객체 스토리지)
      └── 아니오 ↓
          높은 IOPS 필요?
          ├── 예 → EBS io1/io2
          └── 아니오 ↓
              높은 처리량 필요?
              ├── 예 → EBS st1
              └── 아니오 → EBS gp3
```

## 모범 사례

### 1. 적절한 스토리지 선택
- 워크로드 특성 분석
- 성능 요구사항 확인
- 비용 고려

### 2. 계층적 스토리지
- 자주 액세스: EBS, EFS
- 가끔 액세스: S3 Standard-IA
- 아카이브: S3 Glacier

### 3. 백업 전략
- EBS: 스냅샷
- EFS: 백업 도구 또는 스냅샷
- S3: 버전 관리, 수명 주기 정책

### 4. 모니터링
- 사용량 모니터링
- 성능 지표 추적
- 비용 분석

## 관련 서비스

### Storage Gateway
- 온프레미스와 AWS 연결
- 하이브리드 스토리지

### DataSync
- 데이터 전송 및 동기화
- 마이그레이션

### Transfer Family
- 파일 전송 프로토콜
- 외부 시스템 통합

## 참고 자료
- [AWS 스토리지 서비스 비교](https://aws.amazon.com/products/storage/)
- [스토리지 선택 가이드](https://aws.amazon.com/storage/use-cases/)

