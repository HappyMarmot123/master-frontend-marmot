# ElastiCache

## 개요
Amazon ElastiCache는 Redis 및 Memcached와 호환되는 완전 관리형 인메모리 데이터 스토어입니다. 데이터베이스 부하를 줄이고 애플리케이션 성능을 향상시킵니다.

## 핵심 개념

### ElastiCache란?
**정의**: 인메모리 캐싱 서비스

**지원 엔진**:
- **Redis**: 고급 데이터 구조, 복제, 지속성
- **Memcached**: 단순 키-값 스토어, 높은 성능

**작동 원리**:
```
애플리케이션
  ├── 캐시 히트 → ElastiCache (빠른 응답)
  └── 캐시 미스 → 데이터베이스 → ElastiCache에 저장
```

### 캐싱이란?
**정의**: 자주 사용하는 데이터를 빠른 스토리지에 저장

**목적**:
- 데이터베이스 부하 감소
- 응답 시간 단축
- 비용 절감

## ElastiCache for Redis

### Redis 특징
**특징**:
- 고급 데이터 구조 (List, Set, Sorted Set, Hash)
- 복제 지원
- 지속성 (AOF, RDB)
- Pub/Sub 지원
- 트랜잭션 지원

**사용 사례**:
- 세션 스토어
- 실시간 분석
- 게임 리더보드
- 채팅 애플리케이션

### Redis 클러스터 모드
**정의**: 여러 샤드로 데이터 분산

**특징**:
- 수평 확장
- 자동 샤딩
- 고가용성

**구조**:
```
Redis 클러스터
  ├── 샤드 1 (Primary + Replica)
  ├── 샤드 2 (Primary + Replica)
  └── 샤드 3 (Primary + Replica)
```

### Redis 복제
**특징**:
- 읽기 전용 복제본
- 자동 장애 조치
- 읽기 성능 향상

**구조**:
```
Primary (쓰기)
  ↓ (복제)
Replica 1, 2, 3 (읽기)
```

## ElastiCache for Memcached

### Memcached 특징
**특징**:
- 단순 키-값 스토어
- 높은 성능
- 수평 확장
- 복제 없음

**사용 사례**:
- 단순 캐싱
- 세션 스토어
- 높은 처리량 필요

### Memcached 클러스터
**특징**:
- 여러 노드로 분산
- 클라이언트 측 샤딩
- 자동 노드 발견

## Redis vs Memcached 비교

### 비교표

| 항목 | Redis | Memcached |
|------|-------|-----------|
| **데이터 구조** | 다양 (List, Set, Hash 등) | 키-값만 |
| **복제** | 지원 | 미지원 |
| **지속성** | 지원 (AOF, RDB) | 미지원 |
| **트랜잭션** | 지원 | 미지원 |
| **Pub/Sub** | 지원 | 미지원 |
| **성능** | 높음 | 매우 높음 |
| **사용 사례** | 복잡한 데이터 구조 | 단순 캐싱 |

### 선택 기준

#### Redis를 선택하는 경우
- 복잡한 데이터 구조 필요
- 복제 및 지속성 필요
- Pub/Sub 필요
- 트랜잭션 필요

#### Memcached를 선택하는 경우
- 단순 키-값 캐싱
- 최고 성능 필요
- 복제 불필요
- 비용 최적화

## 캐싱 패턴

### 1. Cache-Aside (Lazy Loading)
**정의**: 애플리케이션이 캐시를 직접 관리

**작동 원리**:
```
1. 애플리케이션이 캐시 확인
2. 캐시 히트 → 반환
3. 캐시 미스 → DB 조회 → 캐시 저장 → 반환
```

**장점**:
- 간단한 구현
- 캐시 실패 시에도 작동

**단점**:
- 캐시 미스 시 지연
- 캐시 관리 복잡

### 2. Write-Through
**정의**: 쓰기 시 캐시와 DB 모두 업데이트

**작동 원리**:
```
1. 데이터 쓰기
2. 캐시 업데이트
3. DB 업데이트
```

**장점**:
- 캐시와 DB 일관성
- 읽기 성능 향상

**단점**:
- 쓰기 지연 증가
- 비용 증가

### 3. Write-Back (Write-Behind)
**정의**: 캐시에 먼저 쓰고, 나중에 DB에 쓰기

**작동 원리**:
```
1. 데이터 쓰기 → 캐시
2. 비동기로 DB에 쓰기
```

**장점**:
- 빠른 쓰기
- DB 부하 감소

**단점**:
- 데이터 손실 위험
- 복잡한 구현

## 사용 사례

### 시나리오 1: 데이터베이스 부하 감소
```
웹 애플리케이션
  ├── 자주 조회되는 데이터 → ElastiCache
  └── 가끔 조회되는 데이터 → RDS
```

**효과**:
- 데이터베이스 쿼리 수 감소
- 응답 시간 단축
- 비용 절감

### 시나리오 2: 세션 스토어
```
사용자 로그인
  ↓
세션 데이터 → ElastiCache
  ↓
여러 서버에서 세션 공유
```

**효과**:
- 세션 공유
- 서버 독립성
- 확장성 향상

### 시나리오 3: 실시간 분석
```
이벤트 발생
  ↓
ElastiCache (Redis)에 집계
  ↓
실시간 대시보드
```

## 모범 사례

### 1. 캐시 키 설계
- 의미 있는 키 사용
- 네임스페이스 사용
- TTL 설정

### 2. 캐시 무효화
- 데이터 변경 시 캐시 삭제
- TTL 활용
- 이벤트 기반 무효화

### 3. 고가용성
- Redis 복제 사용
- Multi-AZ 배포
- 자동 장애 조치

### 4. 보안
- VPC 내부 배치
- 보안 그룹으로 액세스 제어
- 암호화 (전송 중, 저장 시)

## 비용

### ElastiCache 비용
**구성**:
- 인스턴스 비용 (시간당)
- 데이터 전송 비용

**비용 최적화**:
- 적절한 인스턴스 크기 선택
- Reserved Instances 활용
- 불필요한 노드 제거

## 관련 서비스

### RDS
- 데이터베이스 부하 감소
- 읽기 성능 향상

### CloudFront
- 엣지 캐싱
- 전역 분산

### Lambda
- 캐시 무효화
- 이벤트 처리

## 참고 자료
- [ElastiCache 공식 문서](https://docs.aws.amazon.com/elasticache/)
- [Redis vs Memcached](https://aws.amazon.com/elasticache/redis-vs-memcached/)
- [캐싱 패턴](https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/Strategies.html)

