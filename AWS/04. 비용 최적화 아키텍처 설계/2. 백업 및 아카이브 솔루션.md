# 백업 및 아카이브 솔루션

## 개요
AWS는 다양한 백업 및 아카이브 솔루션을 제공하여 데이터 보호와 비용 최적화를 동시에 달성할 수 있습니다. 데이터의 중요성과 접근 빈도에 따라 적절한 솔루션을 선택해야 합니다.

## 핵심 개념

### 백업 vs 아카이브
**백업 (Backup)**:
- 데이터 복구 목적
- 빠른 복원 필요
- 자주 액세스
- 비교적 짧은 보관 기간

**아카이브 (Archive)**:
- 장기 보관 목적
- 거의 액세스하지 않음
- 규정 준수 목적
- 긴 보관 기간

## S3 기반 백업 및 아카이브

### S3 스토리지 클래스 선택

#### 백업용
**Standard-IA**:
- 빠른 복원 필요
- 가끔 액세스
- 비용: $0.0125/GB

**Glacier**:
- 몇 시간 내 복원 가능
- 거의 액세스하지 않음
- 비용: $0.004/GB

#### 아카이브용
**Glacier Deep Archive**:
- 장기 보관
- 거의 액세스하지 않음
- 규정 준수 목적
- 비용: $0.00099/GB

### 수명 주기 정책 활용
```
백업 파일:
1. 생성 → Standard-IA
2. 90일 후 → Glacier
3. 7년 후 → Glacier Deep Archive
4. 10년 후 → 삭제 (선택적)
```

## EBS 스냅샷

### EBS 스냅샷이란?
**정의**: 특정 시점의 EBS 볼륨 백업

**특징**:
- 증분 백업 (변경된 블록만 저장)
- S3에 저장
- 다른 리전으로 복사 가능
- AMI 생성 가능

### 스냅샷 비용 최적화

#### 1. 증분 백업 활용
**작동 원리**:
```
첫 스냅샷: 100GB 저장
두 번째 스냅샷: 변경된 10GB만 저장
세 번째 스냅샷: 변경된 5GB만 저장
```

**비용**:
- 첫 스냅샷: 100GB × $0.05 = $5.00
- 두 번째 스냅샷: 10GB × $0.05 = $0.50
- 세 번째 스냅샷: 5GB × $0.05 = $0.25

#### 2. 스냅샷 수명 주기 관리
**전략**:
- 최근 스냅샷: 자주 보관 (일일)
- 오래된 스냅샷: 덜 자주 보관 (주간, 월간)
- 오래된 스냅샷 삭제

**예시**:
```
일일 스냅샷: 최근 7일 보관
주간 스냅샷: 최근 4주 보관
월간 스냅샷: 최근 12개월 보관
```

#### 3. 불필요한 스냅샷 삭제
- 사용하지 않는 스냅샷 정기 삭제
- 자동화된 정책 설정
- 비용 절감

### 스냅샷 자동화
**AWS Backup 사용**:
- 정기적인 스냅샷 생성
- 수명 주기 정책
- 자동 삭제

## RDS 백업

### 자동 백업
**특징**:
- 자동으로 생성
- Point-in-Time Recovery 지원
- 백업 기간: 최대 35일

**비용**:
- 백업 스토리지: GB당 $0.095/월
- 자동 백업 기간에 따라 비용 증가

### 수동 스냅샷
**특징**:
- 수동으로 생성
- 무기한 보관 가능
- 다른 리전으로 복사

**비용 최적화**:
- 필요한 스냅샷만 보관
- 오래된 스냅샷 삭제
- 다른 리전 복사는 필요한 경우만

### 백업 보존 전략
```
일일 백업: 최근 7일
주간 백업: 최근 4주
월간 백업: 최근 12개월
연간 백업: 장기 보관
```

## AWS Backup

### AWS Backup이란?
**정의**: 중앙 집중식 백업 관리 서비스

**지원 서비스**:
- EBS
- RDS
- DynamoDB
- EFS
- Storage Gateway

**특징**:
- 통합 관리
- 자동화된 백업
- 수명 주기 정책
- 비용 최적화

### 백업 계획 (Backup Plan)
**구성**:
- 백업 일정
- 백업 윈도우
- 보존 정책
- 대상 리소스

**예시**:
```
백업 계획: DailyBackup
- 일정: 매일 02:00 UTC
- 보존: 30일
- 대상: 모든 EBS 볼륨
```

### 수명 주기 정책
**전환 옵션**:
- 백업 → 콜드 스토리지
- 백업 → 삭제

**예시**:
```
백업 생성
  ↓
30일 후 → 콜드 스토리지로 전환
  ↓
90일 후 → 삭제
```

## 아카이브 솔루션

### S3 Glacier Deep Archive
**특징**:
- 가장 저렴한 스토리지
- 장기 보관 목적
- 12시간 내 복원
- 규정 준수

**비용**:
- 저장: $0.00099/GB/월
- 검색: GB당 $0.02 (Standard)

**사용 사례**:
- 규정 준수 아카이브
- 장기 보관
- 거의 액세스하지 않는 데이터

### S3 Glacier
**특징**:
- 저렴한 스토리지
- 아카이브 목적
- 몇 시간 내 복원

**비용**:
- 저장: $0.004/GB/월
- 검색: GB당 $0.02 (Standard)

**사용 사례**:
- 백업 아카이브
- 중기 보관
- 가끔 액세스

## 하이브리드 백업 솔루션

### Storage Gateway
**정의**: 온프레미스와 AWS 간 스토리지 브리지

**유형**:

#### 1. Tape Gateway
**특징**:
- S3를 테이프 라이브러리로 노출
- 레거시 백업 시스템 통합
- Glacier로 자동 전환

**사용 사례**:
- 기존 테이프 백업 시스템
- 규정 준수 아카이브

#### 2. Volume Gateway
**특징**:
- EBS 볼륨을 온프레미스에 노출
- 스냅샷을 S3에 저장
- Glacier로 자동 전환

**사용 사례**:
- 온프레미스 서버 백업
- 재해 복구

### DataSync
**정의**: 온프레미스와 AWS 간 데이터 전송

**특징**:
- 빠른 데이터 전송
- 자동화된 동기화
- 네트워크 최적화

**사용 사례**:
- 대량 데이터 마이그레이션
- 정기적인 백업 동기화

## 비용 최적화 전략

### 1. 적절한 스토리지 클래스 선택
**전략**:
- 접근 빈도에 따라 선택
- 자주 액세스: Standard-IA
- 가끔 액세스: Glacier
- 거의 액세스 안 함: Glacier Deep Archive

### 2. 수명 주기 정책 활용
**전략**:
- 자동으로 저렴한 클래스로 전환
- 점진적 전환
- 만료 정책 설정

### 3. 중복 제거
**전략**:
- 중복 백업 제거
- 증분 백업 활용
- 효율적인 스냅샷 관리

### 4. 보존 정책 최적화
**전략**:
- 필요한 기간만 보관
- 규정 준수 요구사항 고려
- 오래된 백업 정기 삭제

## 실제 사용 예시

### 예시 1: 데이터베이스 백업
```
RDS 자동 백업
  ├── 최근 7일: 자동 백업 (빠른 복원)
  ├── 주간 스냅샷: 4주 보관 (S3 Standard-IA)
  └── 월간 스냅샷: 12개월 보관 (S3 Glacier)
```

### 예시 2: 파일 서버 백업
```
온프레미스 파일 서버
  ↓ (Storage Gateway)
S3 Standard-IA (최근 백업)
  ↓ (수명 주기 정책)
S3 Glacier (90일 후)
  ↓
S3 Glacier Deep Archive (1년 후)
```

### 예시 3: 규정 준수 아카이브
```
비즈니스 문서
  ↓
S3 Glacier Deep Archive
  ├── 7년 보관 (규정 준수)
  └── 거의 액세스하지 않음
```

## 모범 사례

### 1. 3-2-1 백업 전략
- **3**: 데이터 3개 복사본
- **2**: 다른 미디어 2개
- **1**: 오프사이트 1개

**AWS 구현**:
- 원본 데이터
- S3 백업
- 다른 리전 복사

### 2. 정기적인 복원 테스트
- 백업 복원 테스트
- RTO/RPO 검증
- 프로세스 문서화

### 3. 자동화
- 자동 백업 설정
- 수명 주기 정책
- 알림 설정

### 4. 모니터링
- 백업 상태 모니터링
- 비용 추적
- 실패 알림

## 관련 서비스

### AWS Backup
- 중앙 집중식 백업 관리
- 자동화

### Storage Gateway
- 하이브리드 백업
- 온프레미스 통합

### DataSync
- 데이터 전송
- 동기화

## 참고 자료
- [AWS Backup 공식 문서](https://docs.aws.amazon.com/aws-backup/)
- [S3 Glacier](https://aws.amazon.com/glacier/)
- [Storage Gateway](https://aws.amazon.com/storagegateway/)

