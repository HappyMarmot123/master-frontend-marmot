# Lambda

## 개요
AWS Lambda는 서버를 프로비저닝하거나 관리할 필요 없이 코드를 실행할 수 있는 서버리스 컴퓨팅 서비스입니다. 이벤트에 응답하여 코드를 실행하고 자동으로 확장합니다.

## 핵심 개념

### 서버리스 컴퓨팅
- **정의**: 서버 관리 없이 코드 실행
- **특징**:
  - 자동 확장
  - 사용한 만큼만 지불
  - 높은 가용성
  - 이벤트 기반 실행

### 실행 환경
- **런타임**: Node.js, Python, Java, Go, .NET, Ruby 등
- **컨테이너 이미지**: 커스텀 런타임
- **메모리**: 128MB ~ 10GB
- **실행 시간**: 최대 15분 (동기), 최대 15분 (비동기)

### 이벤트 소스
- **API Gateway**: HTTP 요청
- **S3**: 객체 생성/삭제
- **DynamoDB**: 스트림 이벤트
- **SQS**: 메시지 수신
- **EventBridge**: 스케줄 또는 이벤트
- **CloudWatch Events**: 이벤트 규칙

## 주요 기능

### 1. 동시성 (Concurrency)
- **예약된 동시성**: 특정 함수에 할당
- **프로비저닝된 동시성**: 항상 준비된 실행 환경
- **예약된 동시성**: 다른 함수의 동시성 보호

### 2. 비동기 실행
- **이벤트 소스 매핑**: 자동 재시도
- **DLQ (Dead Letter Queue)**: 실패한 이벤트 저장
- **대상 (Destination)**: 성공/실패 이벤트 라우팅

### 3. 환경 변수
- **암호화**: KMS를 사용한 암호화
- **버전 관리**: 여러 버전의 환경 변수
- **Secrets Manager 통합**: 시크릿 자동 로테이션

### 4. 레이어 (Layers)
- **목적**: 코드와 종속성 분리
- **용도**: 라이브러리, 커스텀 런타임 공유
- **크기**: 최대 250MB (압축)

### 5. 버전 및 별칭
- **버전**: 함수의 불변 스냅샷
- **별칭**: 버전을 가리키는 포인터
- **가중 트래픽 분할**: A/B 테스트

## 사용 사례

### 1. API 백엔드
- API Gateway와 함께 RESTful API
- 서버리스 웹 애플리케이션
- 마이크로서비스 아키텍처

### 2. 이벤트 처리
- S3 이벤트 처리 (이미지 리사이징)
- DynamoDB 스트림 처리
- 파일 업로드 처리

### 3. 데이터 변환
- ETL 작업
- 데이터 포맷 변환
- 실시간 데이터 처리

### 4. 스케줄 작업
- EventBridge와 함께 스케줄 작업
- 정기적인 백업
- 리소스 정리

## 시험 포인트

1. **비용 모델**
   - 요청 수: 100만 요청당 비용
   - 실행 시간: GB-초 단위
   - 무료 티어: 월 100만 요청, 40만 GB-초

2. **콜드 스타트**
   - 첫 실행 시 지연 시간
   - 프로비저닝된 동시성으로 완화
   - VPC 내 실행 시 더 긴 콜드 스타트

3. **동시성 제한**
   - 계정별 동시성 제한 (기본 1000)
   - 함수별 예약된 동시성 설정 가능
   - 동시성 초과 시 스로틀링

4. **에러 처리**
   - 자동 재시도 (비동기)
   - DLQ로 실패한 이벤트 저장
   - Destination으로 이벤트 라우팅

5. **VPC 통합**
   - VPC 내 리소스 접근 가능
   - ENI 생성으로 콜드 스타트 증가
   - VPC 엔드포인트로 비용 절감

## 모범 사례

1. **함수 설계**
   - 단일 책임 원칙
   - 작은 함수 유지
   - 재사용 가능한 코드

2. **성능 최적화**
   - 적절한 메모리 할당
   - 레이어 사용
   - 연결 풀링 (RDS, DynamoDB)

3. **에러 처리**
   - DLQ 설정
   - 재시도 로직 구현
   - 로깅 및 모니터링

4. **보안**
   - 최소 권한 원칙 (IAM 역할)
   - 환경 변수 암호화
   - Secrets Manager 사용

5. **비용 최적화**
   - 적절한 메모리 할당
   - 예약된 동시성으로 스로틀링 방지
   - 불필요한 실행 시간 최소화

## Lambda 아키텍처 예시

### 서버리스 API
```
API Gateway
  ↓
Lambda (API 핸들러)
  ↓
DynamoDB
```

### 이벤트 처리
```
S3 (이미지 업로드)
  ↓
Lambda (이미지 리사이징)
  ↓
S3 (리사이징된 이미지)
```

### 비동기 처리
```
SQS (메시지)
  ↓
Lambda (처리)
  ↓
DLQ (실패한 메시지)
```

## 관련 서비스
- **API Gateway**: HTTP API 엔드포인트
- **EventBridge**: 이벤트 라우팅
- **Step Functions**: 워크플로 오케스트레이션
- **CloudWatch**: 로깅 및 모니터링

## 참고 자료
- [Lambda 공식 문서](https://docs.aws.amazon.com/lambda/)
- [Lambda 모범 사례](https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html)
- [서버리스 애플리케이션](https://aws.amazon.com/serverless/)

