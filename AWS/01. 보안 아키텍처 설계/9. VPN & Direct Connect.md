# VPN & Direct Connect

## 개요
AWS VPN과 AWS Direct Connect는 온프레미스 환경과 AWS 클라우드를 안전하게 연결하는 네트워크 서비스입니다. 각각 다른 사용 사례와 특성을 가집니다.

## 핵심 개념

### 하이브리드 클라우드 연결이란?
**정의**: 온프레미스 데이터 센터와 AWS 클라우드를 연결하는 것

**필요성**:
- 레거시 시스템과 클라우드 통합
- 데이터 마이그레이션
- 하이브리드 아키텍처
- 규정 준수 요구사항

## AWS VPN

### VPN이란?
**정의**: Virtual Private Network, 인터넷을 통해 암호화된 터널을 생성

**특징**:
- 인터넷을 통한 연결
- 암호화된 터널
- 빠른 설정
- 낮은 비용

**작동 원리**:
```
온프레미스
  ↓ (인터넷)
VPN 터널 (암호화)
  ↓
AWS VPC
```

### VPN 유형

#### 1. Site-to-Site VPN
**정의**: 온프레미스 네트워크와 VPC 간 연결

**구성 요소**:
- **Virtual Private Gateway (VGW)**: VPC에 연결
- **Customer Gateway (CGW)**: 온프레미스에 연결
- **VPN 연결**: 두 게이트웨이 간 터널

**구조**:
```
온프레미스 네트워크
  ↓
Customer Gateway (라우터/방화벽)
  ↓ (인터넷, 암호화)
Virtual Private Gateway
  ↓
VPC
```

**특징**:
- 지속적인 연결
- 여러 터널 지원 (고가용성)
- 자동 장애 조치

#### 2. Client VPN
**정의**: 개별 클라이언트와 VPC 간 연결

**구성 요소**:
- **Client VPN 엔드포인트**: VPC에 연결
- **클라이언트 소프트웨어**: 사용자 디바이스

**사용 사례**:
- 원격 작업자
- 모바일 사용자
- 임시 접근

**특징**:
- 사용자별 인증
- 세션별 연결
- 유연한 접근

### VPN 프로토콜

#### IPsec (Internet Protocol Security)
**정의**: 네트워크 레벨에서 암호화하는 프로토콜

**특징**:
- 강력한 암호화
- 인증 및 무결성
- 표준 프로토콜

**사용 사례**:
- Site-to-Site VPN
- 보안이 중요한 연결

#### SSL/TLS
**정의**: 애플리케이션 레벨에서 암호화하는 프로토콜

**특징**:
- 간단한 설정
- 브라우저 지원
- 높은 호환성

**사용 사례**:
- Client VPN
- 웹 기반 접근

### VPN 고가용성

#### 다중 터널
**구성**:
```
온프레미스
  ↓
Customer Gateway
  ├── 터널 1 → Virtual Private Gateway (AZ A)
  └── 터널 2 → Virtual Private Gateway (AZ B)
```

**장점**:
- 단일 터널 장애 시 자동 전환
- 높은 가용성
- 로드 밸런싱

#### BGP (Border Gateway Protocol)
**정의**: 동적 라우팅 프로토콜

**특징**:
- 자동 라우팅
- 장애 시 자동 경로 변경
- 복잡한 네트워크에 적합

**사용 사례**:
- 복잡한 온프레미스 네트워크
- 다중 경로
- 동적 라우팅 필요

## AWS Direct Connect

### Direct Connect란?
**정의**: 온프레미스와 AWS 간 전용 네트워크 연결

**특징**:
- 전용 물리적 연결
- 높은 대역폭
- 낮은 지연 시간
- 일관된 성능

**작동 원리**:
```
온프레미스 데이터 센터
  ↓ (전용 회선)
Direct Connect 로케이션
  ↓ (AWS 백본 네트워크)
AWS VPC
```

### Direct Connect 구성 요소

#### 1. Direct Connect 로케이션
**정의**: AWS와 연결 지점이 있는 데이터 센터

**특징**:
- 전 세계 100개 이상의 로케이션
- 파트너 데이터 센터
- 물리적 케이블 연결 필요

#### 2. 포트
**정의**: Direct Connect 연결의 물리적 포트

**속도 옵션**:
- 1 Gbps
- 10 Gbps
- 100 Gbps

**비용**: 포트 속도에 따라 다름

#### 3. Virtual Interface (VIF)
**정의**: Direct Connect 연결의 논리적 인터페이스

**유형**:
- **Private VIF**: VPC 연결
- **Public VIF**: AWS 퍼블릭 서비스 연결
- **Transit VIF**: Transit Gateway 연결

### Direct Connect 연결 유형

#### 1. 전용 연결 (Dedicated Connection)
**정의**: 단일 고객 전용 물리적 연결

**특징**:
- 1, 10, 100 Gbps
- 직접 AWS와 계약
- 높은 비용

**사용 사례**:
- 대규모 엔터프라이즈
- 높은 대역폭 필요
- 전용 연결 필요

#### 2. 호스팅 연결 (Hosted Connection)
**정의**: AWS 파트너를 통한 연결

**특징**:
- 50 Mbps ~ 10 Gbps
- 파트너를 통한 주문
- 낮은 비용

**사용 사례**:
- 중소규모 기업
- 빠른 시작
- 낮은 비용

### Direct Connect 고가용성

#### 다중 연결
**구성**:
```
온프레미스
  ├── Direct Connect 1 → AWS 리전 A
  └── Direct Connect 2 → AWS 리전 B
```

**장점**:
- 단일 연결 장애 시 자동 전환
- 높은 가용성
- 로드 밸런싱

#### 다중 로케이션
**구성**:
```
온프레미스
  ├── 로케이션 A → Direct Connect 1
  └── 로케이션 B → Direct Connect 2
```

**장점**:
- 지리적 분산
- 높은 가용성
- 재해 복구

## VPN vs Direct Connect 비교

### 비교표

| 항목 | VPN | Direct Connect |
|------|-----|----------------|
| **연결** | 인터넷 (가상) | 전용 회선 (물리적) |
| **대역폭** | 최대 1.25 Gbps | 1 Gbps ~ 100 Gbps |
| **지연 시간** | 높음 (인터넷) | 낮음 (전용) |
| **비용** | 낮음 | 높음 |
| **설정 시간** | 빠름 (분) | 느림 (주~월) |
| **가용성** | 인터넷 의존 | 높음 |
| **암호화** | 필수 | 선택적 (VPN 오버레이) |

### 선택 기준

#### VPN을 선택하는 경우
- 빠른 시작 필요
- 낮은 비용
- 낮은 대역폭
- 임시 연결
- 소규모 연결

#### Direct Connect를 선택하는 경우
- 높은 대역폭 필요
- 낮은 지연 시간 필요
- 일관된 성능 필요
- 장기적 연결
- 대규모 연결

### 함께 사용하기
```
온프레미스
  ├── Direct Connect (주 연결)
  └── VPN (백업 연결)
```

**장점**:
- Direct Connect 장애 시 VPN으로 자동 전환
- 높은 가용성
- 비용 최적화

## VPN 오버레이

### VPN 오버레이란?
**정의**: Direct Connect 위에 VPN 터널을 추가로 구성

**목적**:
- 추가 보안 (이중 암호화)
- 트래픽 분리
- 규정 준수

**구성**:
```
온프레미스
  ↓ (Direct Connect)
AWS
  ↓ (VPN 터널 추가)
이중 암호화
```

## 사용 사례

### 시나리오 1: 하이브리드 아키텍처
```
온프레미스 데이터 센터
  ↓ (Direct Connect)
AWS VPC
  ├── 레거시 시스템 통합
  └── 클라우드 서비스
```

### 시나리오 2: 데이터 마이그레이션
```
온프레미스
  ↓ (Direct Connect, 높은 대역폭)
AWS
  ↓
대량 데이터 전송
```

### 시나리오 3: 재해 복구
```
프로덕션 (온프레미스)
  ↓ (Direct Connect)
DR 환경 (AWS)
```

## 모범 사례

### VPN 모범 사례
1. **다중 터널**: 고가용성
2. **BGP 사용**: 동적 라우팅
3. **모니터링**: 터널 상태 확인
4. **암호화**: 강력한 암호화 사용

### Direct Connect 모범 사례
1. **다중 연결**: 고가용성
2. **VPN 백업**: Direct Connect 장애 대비
3. **대역폭 계획**: 적절한 포트 속도 선택
4. **모니터링**: 연결 상태 확인

## 비용

### VPN 비용
- **Virtual Private Gateway**: 시간당 $0.05
- **데이터 전송**: GB당 $0.05 (인바운드 무료)

### Direct Connect 비용
- **포트 비용**: 포트 속도에 따라 다름
  - 1 Gbps: 시간당 $0.30
  - 10 Gbps: 시간당 $2.25
- **데이터 전송**: GB당 $0.02 (인바운드 무료)
- **파트너 비용**: 별도 (호스팅 연결)

### 비용 최적화
- 필요한 대역폭만 선택
- 불필요한 연결 제거
- VPN 백업 활용

## 관련 서비스

### Transit Gateway
- 여러 VPC와 온프레미스 연결
- 중앙 집중식 라우팅

### Route 53
- DNS 해결
- 하이브리드 환경 지원

### CloudWatch
- 연결 모니터링
- 성능 지표

## 참고 자료
- [VPN 공식 문서](https://docs.aws.amazon.com/vpn/)
- [Direct Connect 공식 문서](https://docs.aws.amazon.com/directconnect/)
- [하이브리드 네트워크 가이드](https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/)

