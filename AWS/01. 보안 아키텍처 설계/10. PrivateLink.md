# PrivateLink

## 개요
AWS PrivateLink는 VPC와 AWS 서비스, 다른 VPC, 온프레미스 애플리케이션 간에 프라이빗 연결을 제공하는 서비스입니다. 인터넷을 거치지 않고 안전하게 연결할 수 있습니다.

## 핵심 개념

### PrivateLink란?
**정의**: VPC와 서비스 간 프라이빗 연결을 제공하는 서비스

**특징**:
- 인터넷을 거치지 않음
- 프라이빗 IP 주소 사용
- 높은 보안
- 간단한 네트워크 아키텍처

**작동 원리**:
```
VPC A
  ↓ (프라이빗 연결)
PrivateLink
  ↓
VPC B 또는 AWS 서비스
```

### 왜 필요한가?

#### 문제: 인터넷을 통한 접근
**전통적인 방식**:
```
VPC
  ↓ (인터넷 게이트웨이)
인터넷
  ↓ (퍼블릭 엔드포인트)
AWS 서비스
  → 퍼블릭 인터넷 노출
  → 보안 위험
```

**PrivateLink 사용**:
```
VPC
  ↓ (VPC 엔드포인트)
AWS 백본 네트워크
  ↓ (프라이빗 연결)
AWS 서비스
  → 인터넷 노출 없음
  → 높은 보안
```

## PrivateLink 구성 요소

### 1. VPC 엔드포인트 (VPC Endpoint)
**정의**: VPC 내에서 AWS 서비스에 프라이빗 연결을 제공하는 진입점

**유형**:

#### Gateway 엔드포인트
**정의**: 특정 서비스(S3, DynamoDB)를 위한 게이트웨이

**특징**:
- 라우팅 테이블에 추가
- 무료
- S3, DynamoDB만 지원

**구성**:
```
VPC
  ↓
Gateway 엔드포인트
  ↓
S3 또는 DynamoDB
```

#### Interface 엔드포인트
**정의**: ENI를 통해 서비스에 연결

**특징**:
- 여러 서비스 지원
- 보안 그룹으로 제어
- 시간당 비용 발생

**구성**:
```
VPC
  ↓
Interface 엔드포인트 (ENI)
  ↓
AWS 서비스 또는 다른 VPC
```

### 2. 엔드포인트 서비스 (Endpoint Service)
**정의**: 다른 VPC에서 접근할 수 있는 서비스

**특징**:
- NLB 또는 ALB를 통해 노출
- 다른 계정에서 접근 가능
- 승인 필요

**구성**:
```
VPC A (서비스 제공자)
  ├── NLB/ALB
  └── 엔드포인트 서비스 생성

VPC B (서비스 소비자)
  └── VPC 엔드포인트로 접근
```

## PrivateLink 사용 사례

### 1. AWS 서비스 접근

#### S3 접근
**전통적인 방식**:
```
VPC
  ↓ (인터넷 게이트웨이)
인터넷
  ↓
S3 (퍼블릭 엔드포인트)
```

**PrivateLink 사용**:
```
VPC
  ↓ (Gateway 엔드포인트)
S3 (프라이빗 연결)
```

**장점**:
- 인터넷 노출 없음
- 데이터 전송 비용 절감
- 높은 보안

#### 다른 AWS 서비스 접근
**서비스 예시**:
- CloudWatch
- Systems Manager
- KMS
- API Gateway (Private API)

**구성**:
```
VPC
  ↓ (Interface 엔드포인트)
AWS 서비스 (프라이빗 연결)
```

### 2. VPC 간 연결

#### 시나리오: 여러 VPC 간 서비스 공유
```
VPC A (서비스 제공자)
  ├── 애플리케이션 서버
  └── 엔드포인트 서비스

VPC B (서비스 소비자)
  └── VPC 엔드포인트로 VPC A 접근
```

**장점**:
- VPC 피어링 불필요
- 간단한 네트워크 아키텍처
- 중앙 집중식 관리

### 3. 온프레미스와 AWS 연결

#### 시나리오: 온프레미스에서 AWS 서비스 접근
```
온프레미스
  ↓ (Direct Connect 또는 VPN)
AWS VPC
  ↓ (VPC 엔드포인트)
AWS 서비스
```

**장점**:
- 인터넷을 거치지 않음
- 높은 보안
- 일관된 성능

## Gateway 엔드포인트 vs Interface 엔드포인트

### 비교표

| 항목 | Gateway 엔드포인트 | Interface 엔드포인트 |
|------|-------------------|---------------------|
| **지원 서비스** | S3, DynamoDB만 | 대부분의 AWS 서비스 |
| **구현** | 라우팅 테이블 | ENI (Elastic Network Interface) |
| **비용** | 무료 | 시간당 비용 |
| **보안 그룹** | 사용 안 함 | 사용 가능 |
| **DNS** | 자동 | 자동 |

### 선택 기준

#### Gateway 엔드포인트 사용
- S3 또는 DynamoDB 접근
- 비용 최적화
- 간단한 구성

#### Interface 엔드포인트 사용
- 다른 AWS 서비스 접근
- 보안 그룹 제어 필요
- VPC 간 연결

## PrivateLink 보안

### 1. 프라이빗 연결
**특징**:
- 인터넷을 거치지 않음
- AWS 백본 네트워크 사용
- 퍼블릭 IP 주소 불필요

### 2. 보안 그룹
**Interface 엔드포인트**:
- 보안 그룹으로 액세스 제어
- 최소 권한 원칙
- 세밀한 제어

### 3. 정책
**엔드포인트 정책**:
- 엔드포인트 사용 제어
- IAM 정책과 유사
- 액세스 제한

## PrivateLink 비용

### Gateway 엔드포인트
- **무료**: S3, DynamoDB 접근

### Interface 엔드포인트
- **시간당**: $0.01/시간
- **데이터 처리**: GB당 $0.01

### 비용 최적화
- 필요한 엔드포인트만 생성
- 사용하지 않는 엔드포인트 제거
- Gateway 엔드포인트 우선 사용 (S3, DynamoDB)

## 실제 사용 예시

### 예시 1: S3 프라이빗 접근
```
프라이빗 서브넷의 EC2
  ↓ (인터넷 게이트웨이 없음)
Gateway 엔드포인트
  ↓
S3 (프라이빗 연결)
```

### 예시 2: 여러 VPC에서 공유 서비스
```
VPC A (공유 서비스)
  ├── API 서버
  └── 엔드포인트 서비스

VPC B, C, D
  └── VPC 엔드포인트로 VPC A 접근
```

### 예시 3: 마이크로서비스 아키텍처
```
VPC
  ├── 서비스 A
  │   └── Interface 엔드포인트로 서비스 B 접근
  └── 서비스 B
      └── Interface 엔드포인트로 서비스 C 접근
```

## 모범 사례

### 1. 보안
- 보안 그룹으로 액세스 제어
- 최소 권한 원칙
- 정책 설정

### 2. 비용 최적화
- Gateway 엔드포인트 우선 사용
- 불필요한 엔드포인트 제거
- 사용 패턴 분석

### 3. 네트워크 설계
- 여러 서브넷에 엔드포인트 배치
- 고가용성 고려
- 라우팅 최적화

## 관련 서비스

### VPC
- 엔드포인트 배치
- 네트워크 구성

### Direct Connect
- 온프레미스 연결
- PrivateLink와 함께 사용

### Transit Gateway
- 여러 VPC 연결
- 중앙 집중식 라우팅

## 참고 자료
- [PrivateLink 공식 문서](https://docs.aws.amazon.com/vpc/latest/privatelink/)
- [VPC 엔드포인트](https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints.html)

