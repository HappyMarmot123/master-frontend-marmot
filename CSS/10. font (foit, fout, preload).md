# CSS Font 최적화 (FOIT, FOUT, Preload)

## 📖 개요

**CSS Font 최적화**는 웹 폰트 로딩 성능과 사용자 경험을 향상시키기 위한 핵심 기술입니다. FOIT(Flash of Invisible Text), FOUT(Flash of Unstyled Text) 등의 문제를 이해하고 `font-display` 속성과 `preload`를 올바르게 사용하면, 폰트 로딩 중 발생하는 시각적 불편함을 해결하고 빠르고 일관된 타이포그래피 경험을 제공할 수 있습니다. 이는 아름다운 타이포그래피와 빠른 성능을 동시에 달성하는 현대 웹 개발의 필수 역량입니다.

## 🔤 FOIT와 FOUT 이해하기

### 1. **FOIT (Flash of Invisible Text)**

**핵심 요약:**

- **정의**: 웹 폰트가 로딩되는 동안 텍스트가 **완전히 보이지 않는 현상**입니다.
- **문제점**: 사용자가 콘텐츠를 즉시 읽을 수 없어 **사용성이 크게 저하**되며, 폰트 로딩 실패 시 텍스트가 영원히 보이지 않을 위험이 있습니다.
- **발생 원인**: `@font-face` 규칙에 `font-display` 속성을 명시하지 않으면 브라우저의 기본 동작(대부분 `block`과 유사)에 따라 FOIT가 발생할 수 있습니다.
- **핵심 해결책**: `@font-face`에 `font-display: swap;`을 적용하는 것이 가장 일반적이고 효과적인 해결책입니다. 이는 폰트 로딩 여부와 관계없이 **폴백 폰트(fallback font)를 즉시 보여주어** 콘텐츠 공백 상태를 방지합니다.

### 2. **FOUT (Flash of Unstyled Text)**

**핵심 요약:**

- **정의**: 폴백 폰트가 먼저 렌더링된 후, 뒤늦게 웹 폰트 로딩이 완료되면서 **폰트가 교체되어 스타일이 깜빡이는 현상**입니다. `font-display: swap`의 자연스러운 결과입니다.
- **장점**: 콘텐츠를 즉시 볼 수 있어 FOIT보다 사용자 경험이 좋습니다.
- **문제점**: 폰트 교체 시 발생하는 **레이아웃 시프트(Layout Shift)**로 인해 시각적인 불편함을 유발할 수 있습니다.
- **핵심 최적화 전략**:
  1. **유사 폰트 선택**: 웹 폰트와 **글자 폭, 높이 등 메트릭(metrics)이 유사한 폴백 폰트**를 지정하여 교체 시 변화를 최소화합니다.
  2. **메트릭 재정의**: `size-adjust`, `ascent-override`와 같은 CSS 속성을 사용해 폴백 폰트의 크기와 라인 높이를 웹 폰트와 거의 일치하도록 미세 조정합니다.
  3. **Font Loading API 활용**: JavaScript의 Font Loading API를 사용해 폰트 로딩 상태(`loading`, `loaded`, `failed`)를 감지하고, 상태에 따라 CSS 클래스를 동적으로 추가하여 폰트 전환을 더 부드럽게 제어할 수 있습니다.

## ⚡ Font-Display 속성 마스터하기

`font-display` 속성은 폰트가 로딩되는 타임라인을 개발자가 직접 제어하여 FOIT와 FOUT 사이의 균형을 맞추는 핵심 도구입니다.

### **값별 핵심 전략 요약**

- `auto` (기본값): 브라우저에 위임합니다. 대부분 `block`과 유사하게 동작하여 FOIT를 유발할 수 있으므로 명시적인 값 사용을 권장합니다.
- `block`: **FOIT를 감수하고서라도 반드시 해당 웹 폰트를 보여줘야 할 때** 사용합니다. 폰트 로딩 전까지 최대 3초간 텍스트가 보이지 않습니다. (예: 아이콘 폰트, 브랜드 로고 폰트)
- `swap`: **콘텐츠의 가독성이 가장 중요할 때** 사용합니다. 텍스트를 즉시 폴백 폰트로 보여주고, 웹 폰트가 로딩되면 교체합니다. (예: 본문 텍스트)
- `fallback`: **FOIT와 FOUT 사이의 절충안**입니다. 약 100ms 동안만 텍스트를 숨기고, 이후에는 폴백 폰트를 보여줍니다. 폰트가 3초 안에 로딩되면 교체하고, 아니면 폴백 폰트를 계속 사용합니다. (예: 제목, 짧은 브랜드 문구)
- `optional`: **성능이 가장 중요하고 해당 폰트가 없어도 괜찮을 때** 사용합니다. 약 100ms 동안만 로딩을 시도하며, 이 시간 내에 로딩되지 않으면 연결 상태가 좋지 않다고 판단하여 웹 폰트를 아예 사용하지 않습니다. (예: 장식용 폰트, 대시보드 UI 폰트)

## ⭐ Font 최적화를 위한 핵심 원칙 ⭐

#### **`font-display`를 반드시 사용하라**

모든 `@font-face` 선언에 콘텐츠의 중요도에 맞는 `font-display` 값을 명시하여 렌더링 동작을 직접 제어합니다. 대부분의 경우 `swap`이 가장 안전한 선택입니다.

#### **폴백 폰트를 최적화하라**

웹 폰트와 시각적으로 유사한 시스템 폰트를 폴백으로 지정하고, 필요하다면 메트릭 재정의 속성을 사용해 FOUT으로 인한 레이아웃 시프트를 최소화합니다.

#### **폰트 파일을 최적화하라**

필요한 문자만 포함하는 서브셋(subset) 폰트를 사용하고, WOFF2와 같이 압축률이 높은 최신 포맷을 우선적으로 사용합니다.

#### **`preload`를 전략적으로 사용하라**

페이지 렌더링에 필수적인 폰트(예: 헤더, 주요 본문 폰트)는 `<link rel="preload">`를 사용해 다른 리소스보다 먼저 다운로드되도록 우선순위를 높입니다.
